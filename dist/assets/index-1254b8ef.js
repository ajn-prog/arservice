import{u as j,q as b,a as p,i as g,r as y,j as e,f as v,B as c,L as x,m as u,n as d,I as S,h as C}from"./index-1a1c1bd9.js";import{T as N,C as o}from"./Table-4a9f9311.js";import{I as w}from"./IconEye-04073686.js";import{I as P,a as D,S as k}from"./IconTrash-dd89f4b8.js";import{T as I}from"./TextEditor-0e4a0687.js";import{F as K}from"./FileDropzone-adbfc222.js";import{I as F}from"./InstallationSelect-464c174f.js";import{u as M,T as h}from"./use-form-9b70dbb4.js";import"./clamp-73f6bef2.js";async function T({data:s}){const t=new FormData;for(const[a,l]of Object.entries(s))l&&(Array.isArray(l)?l.forEach((n,r)=>{l instanceof File?t.append(`${a}[${r}]`,n,n.name):t.append(`${a}[${r}]`,n)}):t.append(a,l.toString()));return(await p.post("/ar-service/complain",t)).data}function E({config:s}={}){return j(T,{...s,onSuccess:(...t)=>{b.invalidateQueries(["complains"]),s!=null&&s.onSuccess&&s.onSuccess(...t)}})}async function A({params:s}){return(await p.get("/ar-service/complain",{params:s})).data.data}function z({config:s,params:t}={}){return g({...s,queryKey:["complains",t],queryFn:()=>A({params:t}),keepPreviousData:!0})}async function B({id:s}){return(await p.delete(`/ar-service/complain/${s}`)).data}function $({config:s}={}){return j(B,{...s,onSuccess:(...t)=>{b.invalidateQueries(["complains"]),s!=null&&s.onSuccess&&s.onSuccess(...t)}})}const H={page:1,limit:10,search:""},L=({toolbar:s})=>{const[t,m]=y.useState(H),{data:a,isLoading:l}=z({params:t}),n=$();function r(i){return()=>{u.openConfirmModal({title:"Hapus Komplain",children:e.jsx("div",{className:"text-sm",children:"Apakah anda yakin untuk menghapus komplain ini?"}),centered:!0,closeOnConfirm:!1,onConfirm:async()=>{await n.mutateAsync({id:i},{onSuccess:()=>{d.show({message:"Komplain berhasil dihapus",color:"green",icon:e.jsx(D,{})}),u.closeAll()},onError:()=>{d.show({message:"Komplain tidak bisa dihapus",color:"red",icon:e.jsx(S,{})}),u.closeAll()}})}})}}return e.jsx(N,{title:"Tabel Data Komplain",toolbar:s,header:["#","Judul","Prioritas","Produk","Instansi","Status","Diperbaharui",""],items:a==null?void 0:a.data,onPageChange:i=>{m({...t,page:i})},loading:l,metadata:{count:(a==null?void 0:a.data.length)||10,limit:t.limit||10,page:t.page||10,total:(a==null?void 0:a.total)||10},renderItem:(i,f)=>e.jsxs("tr",{children:[e.jsx("td",{children:(t.limit??5)*((t.page??0)-1)+f+1}),e.jsx("td",{children:i.title}),e.jsx("td",{className:"capitalize",children:i.priority}),e.jsx("td",{children:i.installbase.product.name}),e.jsx("td",{children:i.installbase.customer.name}),e.jsx("td",{children:i.status}),e.jsx("td",{children:v(i.updatedAt).format("D MMMM YYYY H:mm")}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{component:x,leftSection:e.jsx(w,{size:16}),to:`/complain/${i.id}`,title:"Update Komplain",color:"primary",size:"xs",children:"Detail"}),e.jsx(c,{leftSection:e.jsx(P,{size:16}),onClick:r(i.id),title:"Hapus Komplain",color:"red",size:"xs",children:"Hapus"})]})})]},i.id)})},q=()=>{const s=C(),{mutateAsync:t,isLoading:m}=E(),a=M({initialValues:{title:"",detail:"",filename:[],installbase_id:void 0,placement_space:"",priority:void 0,status:"open"}}),l=a.onSubmit(async n=>{await t({data:{...n}},{onSuccess:()=>{d.show({color:"green",message:"Komplain berhasil dibuat"}),s("/complain")},onError:({response:r})=>{a.setErrors((r==null?void 0:r.data).errors),d.show({color:"red",message:"Komplain gagal dibuat"})}})});return e.jsxs(o,{component:"form",onSubmit:l,shadow:"lg",children:[e.jsx(o.Section,{p:"lg",withBorder:!0,children:e.jsx("h2",{className:"font-semibold text-base",children:"Tambah Data Komplain"})}),e.jsx(o.Section,{p:"lg",pt:"xs",withBorder:!0,children:e.jsxs("div",{className:"grid grid-cols-12 gap-x-6 gap-y-4",children:[e.jsx(h,{...a.getInputProps("title"),label:"Judul",placeholder:"Masukan Judul",className:"col-span-12 md:col-span-8"}),e.jsx(k,{...a.getInputProps("priority"),label:"Proritas",placeholder:"Pilih Prioritas",data:[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],className:"col-span-12 md:col-span-2"}),e.jsx(h,{...a.getInputProps("placement_space"),label:"Ruang Penempatan",placeholder:"Ex: Radiologi",className:"col-span-12 md:col-span-2"}),e.jsx(F,{...a.getInputProps("installbase_id"),label:"Produk",placeholder:"Pilih Produk",className:"col-span-12 md:col-span-12",nothingFoundMessage:"Data tidak ditemukan"}),e.jsx("div",{className:"col-span-12",children:e.jsx(I,{label:"Detail",value:a.values.detail,onChange:n=>a.setFieldValue("detail",n)})}),e.jsx("div",{className:"col-span-12",children:e.jsx(K,{value:a.values.filename,onDrop:n=>a.setFieldValue("filename",n),label:"Foto/Video Pendukung",maxFiles:5,maxSize:5*1024**2})})]})}),e.jsxs(o.Section,{p:"lg",withBorder:!0,className:"flex items-center space-x-4",children:[e.jsx(c,{type:"submit",loading:m,children:"Simpan"}),e.jsx(c,{component:x,to:"/complain",variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"})]})]})},G=()=>e.jsxs("main",{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Komplain"}),e.jsx(c,{component:x,to:"/complain/create",children:"Tambah"})]}),e.jsx("section",{className:"mb-8",children:e.jsx(L,{})})]}),W=()=>e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Detail Komplain"})}),e.jsx(o,{children:e.jsx(o.Section,{p:"lg",withBorder:!0,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"font-semibold text-base",children:"Detail Komplain #1029"}),e.jsxs("div",{children:["Priority: ",e.jsx("span",{className:"text-primary-600",children:"Medium"})]})]})})})]}),Z=()=>e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Komplain"})}),e.jsx(q,{})]});export{Z as ComplainCreate,W as ComplainDetail,G as Complains};
