import{i as b,a as g,u as y,q as p,j as e,L as u,B as l,m as v,n as x,r as G,f as I,h as j,k as N,S as M}from"./index-1a1c1bd9.js";import{T as C,C as c}from"./Table-4a9f9311.js";import{T as w}from"./TextEditor-0e4a0687.js";import{L as S}from"./LoadingScreen-34b7b5f0.js";import{u as A}from"./getProduct-1886d301.js";import{A as L}from"./Authorization-1a4eb1b2.js";import{I as T}from"./IconEdit-fbfd4397.js";import{I as $}from"./IconTrash-dd89f4b8.js";import{I as P}from"./IconArrowLeft-734b444e.js";import{F as k}from"./FileDropzone-adbfc222.js";import{P as D}from"./ProductSelect-57ba2936.js";import{u as F,T as h}from"./use-form-9b70dbb4.js";import"./clamp-73f6bef2.js";const m={png:"image/png",gif:"image/gif",jpeg:"image/jpeg",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif",mp4:"video/mp4",zip:"application/zip",csv:"text/csv",pdf:"application/pdf",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",exe:"application/vnd.microsoft.portable-executable"},E=[m.png,m.gif,m.jpeg,m.svg,m.webp,m.avif];async function z({params:a}){return(await g.get("/ar-service/guide-product",{params:a})).data.data}function B({config:a,params:s}={}){return b({...a,queryKey:["guide-list",s],queryFn:()=>z({params:s}),keepPreviousData:!0})}async function _({data:a}){const s=new FormData;for(const[t,n]of Object.entries(a))n&&(Array.isArray(n)?n.forEach((i,o)=>{s.append(`${t}[${o}]`,i.toString())}):n instanceof Date?s.append(t,n.toJSON()):n instanceof File?s.append(t,n,n.name):s.append(t,n.toString()));return(await g.post("/ar-service/guide-product",s)).data}function q({config:a}={}){return y(_,{...a,onSuccess:(...s)=>{p.invalidateQueries(["guide-list"]),p.invalidateQueries(["guides"]),a!=null&&a.onSuccess&&a.onSuccess(...s)}})}async function O({id:a}){return(await g.get(`/ar-service/guide-product/${a}`)).data.data}function V({config:a,id:s}){return b({...a,queryKey:["guides",s],queryFn:()=>O({id:s})})}async function Y({id:a}){return(await g.delete(`/ar-service/guide-product/${a}`)).data}function Q({config:a}={}){return y(Y,{...a,onSuccess:(...s)=>{p.invalidateQueries(["guides"]),p.invalidateQueries(["guide-list"]),a!=null&&a.onSuccess&&a.onSuccess(...s)}})}async function J({id:a,data:s}){const r=new FormData;for(const[n,i]of Object.entries(s))i&&(Array.isArray(i)?i.forEach((o,d)=>{r.append(`${n}[${d}]`,o.toString())}):i instanceof Date?r.append(n,i.toJSON()):i instanceof File?r.append(n,i,i.name):r.append(n,i.toString()));return(await g.put(`/ar-service/guide-product/${a}`,r)).data}function K({config:a}={}){return y(J,{...a,onSuccess:(...s)=>{p.invalidateQueries(["guide-list"]),p.invalidateQueries(["guides"]),a!=null&&a.onSuccess&&a.onSuccess(...s)}})}async function H({id:a}){return(await g.get(`/ar-service/guide-product/item/${a}`)).data.data}function U({config:a,id:s}){return b({...a,queryKey:["guide-item",s],queryFn:()=>H({id:s})})}const W=({productId:a})=>{const{data:s,isLoading:r,isError:t}=V({id:a}),n=Q();function i(d,f){return(new DOMParser().parseFromString(d,"text/html").body.textContent||"").split(/\s+/).slice(0,f).join(" ")}function o(d){return()=>{v.openConfirmModal({modalId:"guide-delete",title:"Hapus Panduan",children:e.jsx("div",{className:"text-sm",children:"Apakah Anda yakin untuk menghapus panduan ini?"}),closeOnConfirm:!1,centered:!0,onConfirm:async()=>{await n.mutateAsync({id:d.id},{onSuccess:()=>{x.show({color:"green",message:"Panduan berhasil dihapus"}),v.close("guide-delete")},onError:()=>{x.show({color:"red",message:"Panduan gagal dihapus"}),v.close("guide-delete")}})}})}}return r||t?e.jsx("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array(4).fill(0).map((d,f)=>e.jsxs("div",{className:"w-full bg-white rounded-lg overflow-hidden",children:[e.jsx("div",{className:"w-full aspect-video bg-gray-200 animate-pulse"}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-5 w-20 bg-gray-200 animate-pulse rounded-lg mt-1 mb-2"}),e.jsx("div",{className:"bg-gray-200 animate-pulse h-5 w-full rounded-md mb-2"}),e.jsx("div",{className:"bg-gray-200 animate-pulse h-5 w-1/2 rounded-md mb-2"}),e.jsx("div",{className:"h-4 w-12 bg-gray-200 rounded-md animate-pulse"}),e.jsx("div",{className:"space-y-2 mt-2",children:e.jsx("div",{className:"bg-gray-200 w-full h-7 rounded-md"})})]})]},`skp_${f}`))}):e.jsx("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:s.guide.map(d=>e.jsxs("div",{className:"w-full bg-white rounded-lg overflow-hidden",children:[e.jsx(u,{to:`/guide/${d.id}`,children:e.jsx("div",{className:"w-full aspect-video bg-gray-200 relative",children:d.image&&e.jsx("img",{src:d.image,alt:"",className:"absolute inset-0 w-full h-full object-cover object-center"})})}),e.jsxs("div",{className:"p-4",children:[e.jsxs(u,{to:`/guide/${d.id}`,children:[e.jsx("h2",{className:"line-clamp-2 text-base font-bold mb-1 hover:underline",children:d.title}),e.jsx("p",{className:"text-sm line-clamp-2 text-gray-600",children:i(d.description,15)})]}),e.jsx(L,{role:["Admin","Superadmin"],children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsx(l,{component:u,to:`/guide/${d.id}/update`,variant:"light",leftSection:e.jsx(T,{size:16}),fullWidth:!0,size:"xs",children:"Edit"}),e.jsx(l,{color:"red",variant:"light",leftSection:e.jsx($,{size:16}),fullWidth:!0,size:"xs",onClick:o(d),children:"Hapus"})]})})]})]},d.id))})},R={page:1,limit:10,search:""},X=({toolbar:a})=>{const[s,r]=G.useState(R),{data:t,isLoading:n}=B({params:s});return e.jsx(C,{title:"Tabel Data Panduan",toolbar:a,header:["#","Produk","Diperbaharui",""],items:t==null?void 0:t.data,onPageChange:i=>{r({...s,page:i})},loading:n,metadata:{count:(t==null?void 0:t.data.length)||10,limit:s.limit||10,page:s.page||10,total:(t==null?void 0:t.total)||10},renderItem:(i,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:(s.limit??5)*((s.page??0)-1)+o+1}),e.jsx("td",{children:i.name}),e.jsx("td",{children:I(i.updatedAt).format("D MMMM YYYY H:mm")}),e.jsx("td",{children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(l,{component:u,to:`/guide/product/${i.id}`,size:"xs",children:"Lihat Panduan"})})})]},i.id)})},Z=({product:a})=>{const s=q(),r=j(),t=F({initialValues:{product_id:a,title:"",image:void 0,description:"",video:""}}),n=t.onSubmit(async i=>{await s.mutateAsync({data:i},{onSuccess:()=>{x.show({color:"green",message:"Panduan berhasil dibuat"}),r("/guide")},onError:({response:o})=>{t.setErrors((o==null?void 0:o.data).errors),x.show({color:"red",message:"Panduan gagal dibuat"})}})});return e.jsxs(c,{component:"form",onSubmit:n,shadow:"lg",children:[e.jsx(c.Section,{p:"lg",withBorder:!0,children:e.jsx("h2",{className:"font-semibold text-base",children:"Tambah Data Panduan"})}),e.jsx(c.Section,{p:"lg",pt:"xs",withBorder:!0,children:e.jsxs("div",{className:"grid grid-cols-12 gap-x-6 gap-y-4 border-b border-gray-300",children:[e.jsx(D,{...t.getInputProps("product_id"),label:"Produk",placeholder:"Pilih Produk",className:"col-span-12 md:col-span-12",limit:20,nothingFoundMessage:"Data tidak ditemukan"}),e.jsx(h,{...t.getInputProps("title"),label:"Judul",placeholder:"Masukan Judul",className:"col-span-12"}),e.jsx(h,{...t.getInputProps("video"),label:"Link Video Youtube (Opsional)",placeholder:"https://",className:"col-span-12"}),e.jsx("div",{className:"col-span-12",children:e.jsx(k,{label:"Foto Sampul",value:t.values.image,onDrop:i=>{t.setFieldValue("image",i[0])},accept:E,maxSize:5*1024**2,maxFiles:1,multiple:!1})}),e.jsx("div",{className:"col-span-12",children:e.jsx(w,{value:t.values.description,onChange:i=>t.setFieldValue("description",i)})})]})}),e.jsxs(c.Section,{p:"lg",withBorder:!0,className:"flex justify-start items-center space-x-4",children:[e.jsx(l,{type:"submit",loading:s.isLoading,children:"Simpan"}),e.jsx(l,{component:u,to:"/guide",variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"})]})]})},ee=({guide:a})=>{const s=K(),r=j(),t=F({initialValues:{product_id:a.product_id,title:a.title,image:void 0,description:a.description,video:a.video||void 0}}),n=t.onSubmit(async i=>{await s.mutateAsync({id:a.id,data:i},{onSuccess:()=>{x.show({color:"green",message:"Panduan berhasil dirubah"}),r("/guide")},onError:({response:o})=>{t.setErrors((o==null?void 0:o.data).errors),x.show({color:"red",message:"Panduan gagal dirubah"})}})});return e.jsxs(c,{component:"form",onSubmit:n,shadow:"lg",children:[e.jsx(c.Section,{p:"lg",withBorder:!0,children:e.jsx("h2",{className:"font-semibold text-base",children:"Edit Data Panduan"})}),e.jsx(c.Section,{p:"lg",pt:"xs",withBorder:!0,children:e.jsxs("div",{className:"grid grid-cols-12 gap-x-6 gap-y-4 border-b border-gray-300",children:[e.jsx(D,{...t.getInputProps("product_id"),label:"Produk",placeholder:"Pilih Produk",className:"col-span-12 md:col-span-12",limit:20,nothingFoundMessage:"Data tidak ditemukan"}),e.jsx(h,{...t.getInputProps("title"),label:"Judul",placeholder:"Masukan Judul",className:"col-span-12"}),e.jsx(h,{...t.getInputProps("video"),label:"Link Video Youtube (Opsional)",placeholder:"https://",className:"col-span-12"}),e.jsx("div",{className:"col-span-12",children:e.jsx(k,{label:"Foto Sampul",value:t.values.image,onDrop:i=>{t.setFieldValue("image",i[0])},accept:E,maxSize:5*1024**2,maxFiles:1,multiple:!1})}),e.jsx("div",{className:"col-span-12",children:e.jsx(w,{value:t.values.description,onChange:i=>t.setFieldValue("description",i)})})]})}),e.jsxs(c.Section,{p:"lg",withBorder:!0,className:"flex justify-start items-center space-x-4",children:[e.jsx(l,{type:"submit",loading:s.isLoading,children:"Simpan"}),e.jsx(l,{component:u,to:"/guide",variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"})]})]})},fe=()=>e.jsxs("main",{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Panduan"}),e.jsx(l,{component:u,to:"/guide/create",children:"Tambah"})]}),e.jsx("section",{className:"mb-8",children:e.jsx(X,{})})]}),ve=()=>{const{id:a}=N(),s=j(),{data:r,isLoading:t,isError:n}=A({id:a});return t?e.jsx("div",{className:"mt-48",children:e.jsx(S,{})}):n?e.jsxs("div",{className:"mt-48 text-center",children:[e.jsx("h1",{className:"text-lg font-bold mb-2",children:"Produk tidak ditemukan"}),e.jsx(l,{onClick:()=>s(-1),leftSection:e.jsx(P,{size:14}),children:"Kembali"})]}):e.jsxs("main",{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Panduan Berdasarkan Produk"}),e.jsx(l,{component:u,to:`/guide/create?product=${r.id}`,children:"Tambah"})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:r.name}),e.jsx("p",{className:"text-sm text-primary-600",children:r.brand.name})]}),e.jsx(W,{productId:r.id})]})]})},be=()=>{const[a]=M();return e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Panduan"})}),e.jsx(Z,{product:a.get("product")||void 0})]})},ye=()=>{const{id:a}=N(),{data:s,isLoading:r,isError:t}=U({id:a}),n=j();return r?e.jsx("div",{className:"mt-48",children:e.jsx(S,{})}):t?e.jsxs("div",{className:"mt-48 text-center",children:[e.jsx("h1",{className:"text-lg font-bold mb-2",children:"Produk tidak ditemukan"}),e.jsx(l,{onClick:()=>n(-1),leftSection:e.jsx(P,{size:14}),children:"Kembali"})]}):e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Panduan"})}),e.jsx(ee,{guide:s})]})},Ne=()=>e.jsx("div",{});export{be as GuideCreate,Ne as GuideDetail,ye as GuideUpdate,fe as Guides,ve as ProductGuides};
