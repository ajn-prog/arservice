import{Q as ha,w as u,R as ke,M as re,x as ga,y as va,E as fa,z as je,r as I,D as xa,P as ya,J as ba,K as ja,S as _a,c as H,j as a,L as k,u as S,q as f,a as y,e as Oe,i as ce,T as ae,f as _e,t as m,n as h,I as Sa,p as $e,U as wa,B as p,d as Ee,V as Ca,W as Pa,b as oe,v as Na,h as Ma}from"./index-3804b4f6.js";import{A as Ia}from"./AgencySelect-aced4fa1.js";import{T as ka}from"./Table-7ac38d13.js";import{I as Oa}from"./IconEye-33283115.js";import{I as $a}from"./IconTrash-058ee90d.js";import{I as Ea,u as Da,L as Ra}from"./LoadingScreen-d6037008.js";import{T as De}from"./TextEditor-221afc69.js";import{T as L}from"./TextInput-aa5c3f65.js";import{I as Va}from"./IconSearch-80e0d02f.js";import{C as _,S as de}from"./Select-549d4544.js";import{I as Se}from"./IconCategory-5aeda469.js";import{I as Fa}from"./IconPaperclip-fae89d9c.js";import{c as za}from"./clamp-73f6bef2.js";import{F as Re}from"./FileDropzone-42782af1.js";import{u as me}from"./use-form-791e63de.js";import{D as Ba}from"./DateInput-82398ebe.js";import{I as Aa}from"./IconArrowLeft-19faf7a4.js";import{B as La}from"./BrandSelect-997e5c98.js";import{P as Ta}from"./ProductSelect-9bd412b0.js";import{I as Ka}from"./ItemSelect-8d6beda7.js";import{R as te}from"./Radio-d15b125b.js";import"./get-base-value-abf024f9.js";import"./ScrollArea-e9ffbfea.js";import"./LoadingOverlay-fd806ffd.js";const[Ya,Ve]=ha("Rating was not found in tree");var Ha={root:"m-f8d312f2",symbolGroup:"m-61734bb7",starSymbol:"m-5662a89a",input:"m-211007ba",label:"m-21342ee4",symbolBody:"m-fae05d6a"};const Fe=Ha;var Qa=Object.defineProperty,T=Object.getOwnPropertySymbols,ze=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable,we=(e,t,s)=>t in e?Qa(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Ce=(e,t)=>{for(var s in t||(t={}))ze.call(t,s)&&we(e,s,t[s]);if(T)for(var s of T(t))Be.call(t,s)&&we(e,s,t[s]);return e},qa=(e,t)=>{var s={};for(var n in e)ze.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&T)for(var n of T(e))t.indexOf(n)<0&&Be.call(e,n)&&(s[n]=e[n]);return s};function Ae(e){const t=e,{width:s,height:n,style:l}=t,r=qa(t,["width","height","style"]);return u.createElement("svg",Ce({viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:Ce({width:s,height:n},l)},r),u.createElement("path",{d:"M12 17.75l-6.172 3.245l1.179 -6.873l-5 -4.867l6.9 -1l3.086 -6.253l3.086 6.253l6.9 1l-5 4.867l1.179 6.873z"}))}Ae.displayName="@mantine/core/StarIcon";var Ga=Object.defineProperty,Ja=Object.defineProperties,Ua=Object.getOwnPropertyDescriptors,Pe=Object.getOwnPropertySymbols,Wa=Object.prototype.hasOwnProperty,Xa=Object.prototype.propertyIsEnumerable,Ne=(e,t,s)=>t in e?Ga(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Za=(e,t)=>{for(var s in t||(t={}))Wa.call(t,s)&&Ne(e,s,t[s]);if(Pe)for(var s of Pe(t))Xa.call(t,s)&&Ne(e,s,t[s]);return e},et=(e,t)=>Ja(e,Ua(t));function ie({type:e}){const t=Ve();return u.createElement(Ae,et(Za({},t.getStyles("starSymbol")),{"data-filled":e==="full"||void 0}))}ie.displayName="@mantine/core/StarSymbol";var at=Object.defineProperty,tt=Object.defineProperties,st=Object.getOwnPropertyDescriptors,K=Object.getOwnPropertySymbols,Le=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable,Me=(e,t,s)=>t in e?at(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,A=(e,t)=>{for(var s in t||(t={}))Le.call(t,s)&&Me(e,s,t[s]);if(K)for(var s of K(t))Te.call(t,s)&&Me(e,s,t[s]);return e},se=(e,t)=>tt(e,st(t)),nt=(e,t)=>{var s={};for(var n in e)Le.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&K)for(var n of K(e))t.indexOf(n)<0&&Te.call(e,n)&&(s[n]=e[n]);return s};function Ke(e){var t=e,{size:s,getSymbolLabel:n,emptyIcon:l,fullIcon:r,full:c,active:o,value:i,readOnly:x,fractionValue:b,color:D,id:w,onBlur:Q,onChange:R,onInputChange:q,style:pe}=t,V=nt(t,["size","getSymbolLabel","emptyIcon","fullIcon","full","active","value","readOnly","fractionValue","color","id","onBlur","onChange","onInputChange","style"]),v;const C=Ve(),P=typeof r=="function"?r(i):r,F=typeof l=="function"?l(i):l,{dir:z}=ke();return u.createElement(u.Fragment,null,!x&&u.createElement("input",A(se(A({},C.getStyles("input")),{onKeyDown:B=>B.key===" "&&R(i),id:w,type:"radio","data-active":o||void 0,"aria-label":n==null?void 0:n(i),value:i,onBlur:Q,onChange:q}),V)),u.createElement(re,se(A({component:x?"div":"label"},C.getStyles("label")),{"data-read-only":x||void 0,htmlFor:w,onClick:()=>R(i),__vars:{"--rating-item-z-index":(v=b===1?void 0:o?2:0)==null?void 0:v.toString()}}),u.createElement(re,se(A({},C.getStyles("symbolBody")),{__vars:{"--rating-symbol-clip-path":b===1?void 0:z==="ltr"?`inset(0 ${o?100-b*100:100}% 0 0)`:`inset(0 0 0 ${o?100-b*100:100}% )`}}),c?P||u.createElement(ie,{type:"full"}):F||u.createElement(ie,{type:"empty"}))))}Ke.displayName="@mantine/core/RatingItem";var lt=Object.defineProperty,rt=Object.defineProperties,ot=Object.getOwnPropertyDescriptors,Y=Object.getOwnPropertySymbols,Ye=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable,Ie=(e,t,s)=>t in e?lt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,ne=(e,t)=>{for(var s in t||(t={}))Ye.call(t,s)&&Ie(e,s,t[s]);if(Y)for(var s of Y(t))He.call(t,s)&&Ie(e,s,t[s]);return e},it=(e,t)=>rt(e,ot(t)),ct=(e,t)=>{var s={};for(var n in e)Ye.call(e,n)&&t.indexOf(n)<0&&(s[n]=e[n]);if(e!=null&&Y)for(var n of Y(e))t.indexOf(n)<0&&He.call(e,n)&&(s[n]=e[n]);return s};function le(e,t){var s;const n=Math.round(e/t)*t,l=((s=`${t}`.split(".")[1])==null?void 0:s.length)||0;return Number(n.toFixed(l))}const dt={size:"sm",getSymbolLabel:e=>`${e}`,count:5,fractions:1,color:"yellow"},mt=ba((e,{size:t,color:s})=>({root:{"--rating-size":ja(t,"rating-size"),"--rating-color":_a(s,e)}})),ue=ga((e,t)=>{const s=va("Rating",dt,e),n=s,{classNames:l,className:r,style:c,styles:o,unstyled:i,vars:x,name:b,id:D,value:w,defaultValue:Q,onChange:R,fractions:q,count:pe,onMouseEnter:V,readOnly:v,onMouseMove:C,onHover:P,onMouseLeave:F,onTouchStart:z,onTouchEnd:B,size:he,variant:Ge,getSymbolLabel:Je,color:Bt,emptySymbol:Ue,fullSymbol:We,highlightSelectedOnly:Xe}=n,Ze=ct(n,["classNames","className","style","styles","unstyled","vars","name","id","value","defaultValue","onChange","fractions","count","onMouseEnter","readOnly","onMouseMove","onHover","onMouseLeave","onTouchStart","onTouchEnd","size","variant","getSymbolLabel","color","emptySymbol","fullSymbol","highlightSelectedOnly"]),G=fa({name:"Rating",classes:Fe,props:s,className:r,style:c,classNames:l,styles:o,unstyled:i,vars:x,varsResolver:mt}),{dir:ea}=ke(),aa=je(b),ge=je(D),ve=I.useRef(null),[ta,J]=xa({value:w,defaultValue:Q,finalValue:0,onChange:R}),[O,$]=I.useState(-1),[sa,fe]=I.useState(!0),U=Math.floor(q),W=Math.floor(pe),N=1/U,xe=le(ta,N),X=O!==-1?O:xe,ye=d=>{const{left:g,right:j,width:Z}=ve.current.getBoundingClientRect(),ee=Z/W,E=(ea==="rtl"?j-d:d-g)/ee;return za(le(E+N/2,N),N,W)},na=d=>{V==null||V(d),!v&&fe(!1)},la=d=>{if(C==null||C(d),v)return;const g=ye(d.clientX);$(g),g!==O&&(P==null||P(g))},ra=d=>{F==null||F(d),!v&&($(-1),fe(!0),O!==-1&&(P==null||P(-1)))},oa=d=>{d.preventDefault();const{touches:g}=d;if(g.length!==1)return;const j=g[0];J(ye(j.clientX)),z==null||z(d)},ia=d=>{d.preventDefault(),B==null||B(d)},ca=()=>sa&&$(-1),da=d=>{v||$(typeof d=="number"?d:parseFloat(d.target.value))},ma=d=>{v||J(typeof d=="number"?d:parseFloat(d.target.value))},ua=Array(W).fill(0).map((d,g)=>{const j=g+1,Z=Array.from(new Array(g===0?U+1:U)),ee=!v&&Math.ceil(O)===j;return u.createElement("div",ne({key:j,"data-active":ee||void 0},G("symbolGroup")),Z.map((pa,E)=>{const be=N*(g===0?E:E+1),M=le(j-1+be,N);return u.createElement(Ke,{key:`${j}-${M}`,size:he,getSymbolLabel:Je,emptyIcon:Ue,fullIcon:We,full:Xe?M===X:M<=X,active:M===X,checked:M===xe,readOnly:v,fractionValue:be,value:M,name:aa,onChange:ma,onBlur:ca,onInputChange:da,id:`${ge}-${g}-${E}`})}))});return u.createElement(Ya,{value:{getStyles:G}},u.createElement(re,ne(it(ne({ref:ya(ve,t)},G("root")),{onMouseMove:la,onMouseEnter:na,onMouseLeave:ra,onTouchStart:oa,onTouchEnd:ia,variant:Ge,size:he,id:ge}),Ze),ua))});ue.classes=Fe;ue.displayName="@mantine/core/Rating";var ut=H("brand-whatsapp","IconBrandWhatsapp",[["path",{d:"M3 21l1.65 -3.8a9 9 0 1 1 3.4 2.9l-5.05 .9",key:"svg-0"}],["path",{d:"M9 10a.5 .5 0 0 0 1 0v-1a.5 .5 0 0 0 -1 0v1a5 5 0 0 0 5 5h1a.5 .5 0 0 0 0 -1h-1a.5 .5 0 0 0 0 1",key:"svg-1"}]]),pt=H("map-pin","IconMapPin",[["path",{d:"M9 11a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-0"}],["path",{d:"M17.657 16.657l-4.243 4.243a2 2 0 0 1 -2.827 0l-4.244 -4.243a8 8 0 1 1 11.314 0z",key:"svg-1"}]]),ht=H("message","IconMessage",[["path",{d:"M8 9h8",key:"svg-0"}],["path",{d:"M8 13h6",key:"svg-1"}],["path",{d:"M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3h12z",key:"svg-2"}]]),gt=H("phone-call","IconPhoneCall",[["path",{d:"M5 4h4l2 5l-2.5 1.5a11 11 0 0 0 5 5l1.5 -2.5l5 2v4a2 2 0 0 1 -2 2a16 16 0 0 1 -15 -15a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M15 7a2 2 0 0 1 2 2",key:"svg-1"}],["path",{d:"M15 3a6 6 0 0 1 6 6",key:"svg-2"}]]);const Qe=({files:e})=>{function t(s){try{const r=new URL(s).pathname.split("/"),c=r[r.length-1];return c!==""?c:null}catch{return"unknown file"}}return a.jsx("div",{className:"space-y-1",children:e.map((s,n)=>a.jsxs(k,{to:s,target:"_blank",className:"flex items-center text-sm text-primary-600 line-clamp-1",children:[a.jsx(Fa,{size:16,className:"flex-shrink-0"}),a.jsx("span",{className:"ml-2",children:t(s)})]},`${s}_${n}`))})};async function vt({data:e}){const t=new FormData;for(const[n,l]of Object.entries(e))l&&(Array.isArray(l)?l.forEach((r,c)=>{l instanceof File?t.append(`${n}[${c}]`,r,r.name):t.append(`${n}[${c}]`,r)}):t.append(n,l.toString()));return(await y.post(e.buying=="internal"?"/ar-service/complain":"/ar-service/complain-external",t)).data}function ft({config:e}={}){return S(vt,{...e,onSuccess:(...t)=>{f.invalidateQueries(["complains"]),e!=null&&e.onSuccess&&e.onSuccess(...t)}})}async function xt({params:e}){return(await y.get("/ar-service/complain",{params:e})).data.data}function yt({config:e,params:t}={}){return Oe({...e,queryKey:["complains",t],queryFn:()=>xt({params:t}),keepPreviousData:!0})}async function bt({id:e}){return(await y.get(`/ar-service/complain/${e}`)).data.data}function jt({config:e,id:t}){return Oe({...e,queryKey:["complain",t],queryFn:()=>bt({id:t})})}async function _t({id:e}){return(await y.delete(`/ar-service/complain/${e}`)).data}function St({config:e}={}){return S(_t,{...e,onSuccess:(...t)=>{f.invalidateQueries(["complains"]),e!=null&&e.onSuccess&&e.onSuccess(...t)}})}async function wt({data:e}){const t=new FormData;for(const[n,l]of Object.entries(e))l&&(Array.isArray(l)?l.forEach((r,c)=>{r instanceof File?t.append(`${n}[${c}]`,r,r.name):t.append(`${n}[${c}]`,r)}):t.append(n,l.toString()));return(await y.post("/ar-service/complain/reply",t)).data}function Ct({config:e}={}){return S(wt,{...e,onSuccess:(...t)=>{f.invalidateQueries(["complain"]),e!=null&&e.onSuccess&&e.onSuccess(...t)}})}async function Pt({id:e,data:t}){return(await y.post(`/ar-service/close-complain/${e}`,t)).data}function Nt({config:e}={}){return S(Pt,{...e,onSuccess:(...t)=>{f.invalidateQueries(["complains"]),f.invalidateQueries(["complain"]),e!=null&&e.onSuccess&&e.onSuccess(...t)}})}async function Mt({data:e}){return(await y.post("/ar-service/open-call",e)).data}function It({config:e}={}){return S(Mt,{...e,onSuccess:(...t)=>{f.invalidateQueries(["complains"]),f.invalidateQueries(["complain"]),e!=null&&e.onSuccess&&e.onSuccess(...t)}})}async function kt({data:e}){return(await y.post("/ar-service/complain-rate",e)).data}function Ot({config:e}={}){return S(kt,{...e,onSuccess:(...t)=>{f.invalidateQueries(["complains"]),f.invalidateQueries(["complain"]),e!=null&&e.onSuccess&&e.onSuccess(...t)}})}async function $t({data:e}){return(await y.post("/ar-service/complain-visit",{...e,visit_date:ce(e.visit_date).format("YYYY-MM-DD")})).data}function Et({config:e}={}){return S($t,{...e,onSuccess:(...t)=>{f.invalidateQueries(["complain"]),e!=null&&e.onSuccess&&e.onSuccess(...t)}})}const qe=({status:e,...t})=>{switch(e){case"progress":return a.jsx(ae,{variant:"light",color:"gray",...t,children:"Diproses"});case"close":return a.jsx(ae,{variant:"light",color:"green",...t,children:"Selesai"});case"waiting":return a.jsx(ae,{variant:"light",color:"red",...t,children:"Menunggu"});default:return null}},Dt=({toolbar:e,...t})=>{const[s,n]=I.useState({page:1,limit:10,search:""}),{data:l,isLoading:r}=yt({params:{...s,...t}}),c=St();function o(i){return()=>{m.openConfirmModal({title:"Hapus Komplain",children:a.jsx("div",{className:"text-sm",children:"Apakah anda yakin untuk menghapus komplain ini?"}),centered:!0,onConfirm:async()=>{await c.mutateAsync({id:i},{onSuccess:()=>{h.show({message:"Komplain berhasil dihapus",color:"green",icon:a.jsx(Ea,{})}),m.closeAll()},onError:()=>{h.show({message:"Komplain tidak bisa dihapus",color:"red",icon:a.jsx(Sa,{})}),m.closeAll()}})}})}}return a.jsx(ka,{title:"Tabel Data Komplain",toolbar:e,header:["#","Judul","Prioritas","Produk","Instansi","Status","Diperbaharui",""],items:l==null?void 0:l.data,onPageChange:i=>{n({...s,page:i})},loading:r,metadata:{count:(l==null?void 0:l.data.length)||10,limit:s.limit||10,page:s.page||10,total:(l==null?void 0:l.total)||10},renderItem:(i,x)=>a.jsxs("tr",{children:[a.jsx("td",{children:(s.limit??5)*((s.page??0)-1)+x+1}),a.jsx("td",{children:i.title}),a.jsx("td",{className:"capitalize",children:i.priority}),a.jsx("td",{children:i.installbase_detail.product.name}),a.jsx("td",{children:i.customer.name}),a.jsx("td",{children:a.jsx(qe,{status:i.status})}),a.jsx("td",{children:ce(i.updated_at).format("D MMMM YYYY H:mm")}),a.jsx("td",{children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(_e,{component:k,to:`/complain/${i.id}`,title:"Detail Komplain",color:"gray",radius:"lg",variant:"subtle",children:a.jsx(Oa,{size:16})}),a.jsx(_e,{onClick:o(i.id),title:"Hapus Komplain",color:"red",radius:"lg",variant:"subtle",children:a.jsx($a,{size:16})})]})})]},i.id)})},Rt=()=>{const e=$e(),{mutateAsync:t,isLoading:s}=ft(),n=me({initialValues:{title:"",detail:"",filename:[],installbase_id:void 0,placement_space:"",priority:void 0,status:"waiting",buying:"internal",brand_name:void 0,product_name:void 0,serial_number:void 0}}),[l,r]=I.useState({product:void 0,brand:void 0}),c=n.onSubmit(async o=>{await t({data:{...o}},{onSuccess:()=>{h.show({color:"green",message:"Komplain berhasil dibuat"}),e("/complain")},onError:({response:i})=>{n.setErrors((i==null?void 0:i.data).errors),h.show({color:"red",message:"Komplain gagal dibuat"})}})});return a.jsxs(_,{component:"form",onSubmit:c,shadow:"lg",children:[a.jsx(_.Section,{p:"lg",withBorder:!0,children:a.jsx("h2",{className:"font-semibold text-base",children:"Tambah Data Komplain"})}),a.jsx(_.Section,{p:"lg",pt:"xs",withBorder:!0,children:a.jsxs("div",{className:"grid grid-cols-12 gap-x-6 gap-y-4",children:[a.jsx(L,{...n.getInputProps("title"),label:"Judul",placeholder:"Masukan Judul",className:"col-span-12 md:col-span-8"}),a.jsx(de,{...n.getInputProps("priority"),label:"Proritas",placeholder:"Pilih Prioritas",data:[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],className:"col-span-12 md:col-span-2"}),a.jsx(L,{...n.getInputProps("placement_space"),label:"Ruang Penempatan",placeholder:"Ex: Radiologi",className:"col-span-12 md:col-span-2"}),a.jsx("div",{className:"col-span-12",children:a.jsx(te.Group,{...n.getInputProps("buying"),label:"Pembelian Produk",children:a.jsxs(wa,{mt:"xs",children:[a.jsx(te,{value:"internal",label:"Di Kami"}),a.jsx(te,{value:"external",label:"Di Tempat Lain"})]})})}),n.values.buying=="internal"?a.jsx(Ka,{...n.getInputProps("installbase_id"),label:"Produk",placeholder:"Pilih Produk",className:"col-span-12 md:col-span-12",nothingFoundMessage:"Data tidak ditemukan"}):a.jsxs(a.Fragment,{children:[a.jsx(La,{label:"Brand",placeholder:"Masukan Brand",className:"col-span-12 lg:col-span-4",value:l.brand,onChange:o=>r({...l,brand:o||void 0}),onSelectChange:o=>n.setFieldValue("brand_name",o==null?void 0:o.name)}),a.jsx(Ta,{label:"Produk",placeholder:l.brand?"Masukan Product":"Harap isi brand terlebih dahulu",className:"col-span-12 lg:col-span-4",value:l.product,onChange:o=>r({...l,product:o||void 0}),disabled:!l.brand,brand:l.brand,nothingFoundMessage:"Produk tidak ditemukan",onSelectChange:o=>n.setFieldValue("product_name",o==null?void 0:o.name)}),a.jsx(L,{...n.getInputProps("serial_number"),label:"Serial Number",placeholder:"Masukan Serial Number",className:"col-span-12 lg:col-span-4"})]}),a.jsx("div",{className:"col-span-12",children:a.jsx(De,{label:"Detail",value:n.values.detail||"",onChange:o=>n.setFieldValue("detail",o)})}),a.jsx("div",{className:"col-span-12",children:a.jsx(Re,{value:n.values.filename,onDrop:o=>n.setFieldValue("filename",o),label:"Foto/Video Pendukung",maxFiles:5,maxSize:5*1024**2})})]})}),a.jsxs(_.Section,{p:"lg",withBorder:!0,className:"flex items-center space-x-4",children:[a.jsx(p,{type:"submit",loading:s,children:"Simpan"}),a.jsx(p,{component:k,to:"/complain",variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"})]})]})},Vt=({replies:e})=>{const{creds:t}=Ee(),s=Ot();async function n(l,r){await s.mutateAsync({data:{complain_reply_id:l,rate:r}},{onSuccess:()=>h.show({message:"Terima kasih atas feedback Anda",color:"green"}),onError:()=>h.show({message:"Gagal menambah rating",color:"red"})})}return e.length==0?a.jsx("div",{className:"text-gray-600",children:"Belum ada balasan"}):a.jsx("div",{className:"space-y-4",children:e.map(l=>a.jsxs("div",{className:"border border-gray-300 rounded-md",children:[a.jsx("div",{className:"p-4 border-b border-gray-300 flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"p-2 bg-gray-200 text-gray-600 rounded-full",children:a.jsx(Ca,{size:24})}),a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-sm",children:l.user.profile.name}),a.jsx("div",{className:"text-xs text-gray-600",children:Pa(l.created_at).format("D MMMM YYYY HH:mm")})]})]})}),a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"prose prose-sm mb-2",dangerouslySetInnerHTML:{__html:l.detail}}),a.jsx(Qe,{files:l.complain_files.map(({filename:r})=>r)}),a.jsx("div",{className:"mt-3",children:a.jsx(ue,{value:l.rate,readOnly:(t==null?void 0:t.role)!="Customer",onChange:r=>{s.isLoading||n(l.id,r)}})})]})]},l.id))})},Ft=({complain:e,onCancel:t,onSuccess:s})=>{const n=Ct(),l=me({initialValues:{complain_id:e,detail:"",filename:[]}}),r=l.onSubmit(async c=>{await n.mutateAsync({data:c},{onSuccess:()=>{h.show({color:"green",message:"Balasan berhasil dibuat"}),s&&s()},onError:({response:o})=>{l.setErrors((o==null?void 0:o.data).errors),h.show({color:"red",message:"Balasan gagal dibuat"})}})});return a.jsxs("form",{onSubmit:r,children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-6 gap-y-4",children:[a.jsx("div",{className:"col-span-12",children:a.jsx(De,{label:"Pesan",value:l.values.detail,onChange:c=>l.setFieldValue("detail",c)})}),a.jsx("div",{className:"col-span-12",children:a.jsx(Re,{value:l.values.filename,onDrop:c=>l.setFieldValue("filename",c),label:"Foto/Video Pendukung",maxFiles:5,maxSize:5*1024**2})})]}),a.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[a.jsx(p,{type:"submit",loading:n.isLoading,children:"Simpan"}),a.jsx(p,{variant:"light",color:"gray.6",bg:"gray.2",onClick:t,loading:n.isLoading,children:"Batal"})]})]})},zt=({complain:e,onCancel:t,onSuccess:s})=>{const n=Et(),l=me({initialValues:{complain_id:e,visit_date:void 0,visit_type:void 0}}),r=l.onSubmit(async c=>{await n.mutateAsync({data:c},{onSuccess:()=>{h.show({color:"green",message:"Balasan berhasil dibuat"}),s&&s()},onError:({response:o})=>{l.setErrors((o==null?void 0:o.data).errors),h.show({color:"red",message:"Balasan gagal dibuat"})}})});return a.jsxs("form",{onSubmit:r,children:[a.jsxs("div",{className:"grid grid-cols-12 gap-x-6 gap-y-4",children:[a.jsx(Ba,{...l.getInputProps("visit_date"),label:"Tanggal Rencana Kunjungan",placeholder:"Pilih Tanggal",className:"col-span-12",valueFormat:"D MMMM YYYY"}),a.jsx(de,{...l.getInputProps("visit_type"),label:"Jenis Kunjungan",placeholder:"Pilih Jenis Kunjungan",data:["Customer Visit","Corective Maintenance","Preventive Maintenance"],className:"col-span-12"})]}),a.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[a.jsx(p,{type:"submit",loading:n.isLoading,children:"Simpan"}),a.jsx(p,{variant:"light",color:"gray.6",bg:"gray.2",onClick:t,loading:n.isLoading,children:"Batal"})]})]})},ds=()=>{var n,l;const[e,t]=I.useState({search:"",status:void 0,customer_id:void 0}),[s]=Da(e,200);return a.jsxs("main",{children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[a.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Komplain"}),a.jsx(oe,{role:["Customer"],children:a.jsx(p,{component:k,to:"/complain/create",children:"Tambah"})})]}),a.jsx("section",{className:"space-y-4 mb-4",children:a.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[a.jsx("div",{className:"col-span-12 md:col-span-6 lg:col-span-3",children:a.jsx(L,{leftSection:a.jsx(Va,{size:16}),placeholder:"Cari berdasarkan judul",value:e.search,onChange:r=>t({...e,search:r.target.value})})}),a.jsx("div",{className:"col-span-6 md:col-span-3 lg:col-span-2",children:a.jsx(de,{leftSection:a.jsx(Se,{size:16}),placeholder:"Pilih Status",data:[{label:"Selesai",value:"close"},{label:"Diproses",value:"progress"},{label:"Menunggu",value:"waiting"}],value:((n=e.status)==null?void 0:n.toString())??null,onChange:r=>{t({...e,status:r||void 0})}})}),a.jsx(oe,{role:["-Customer"],children:a.jsx("div",{className:"col-span-6 md:col-span-3 lg:col-span-2",children:a.jsx(Ia,{leftSection:a.jsx(Se,{size:16}),placeholder:"Pilih Instansi",value:((l=e.customer_id)==null?void 0:l.toString())??null,onChange:r=>{t({...e,customer_id:r||void 0})}})})})]})}),a.jsx("section",{className:"mb-8",children:a.jsx(Dt,{...s})})]})},ms=()=>{const{id:e}=Na(),t=$e(),s=Nt(),n=It(),{creds:l}=Ee(),{data:r,isLoading:c,isError:o}=jt({id:e});function i(){r&&m.open({modalId:"complain-reply",title:"Balas Komplain",size:"xl",children:a.jsx(Ft,{complain:r.id,onCancel:()=>m.close("complain-reply"),onSuccess:()=>m.close("complain-reply")})})}function x(){r&&m.open({modalId:"complain-visit",title:"Form Rencana Kunjungan",size:"xl",children:a.jsx(zt,{complain:r.id,onCancel:()=>m.close("complain-visit"),onSuccess:()=>m.close("complain-visit")})})}function b(){m.openConfirmModal({title:"Open Call",children:a.jsx("div",{className:"text-sm",children:"Apakah anda yakin untuk 'open call' untuk komplain ini?"}),centered:!0,onConfirm:async()=>{await n.mutateAsync({data:{id:(r==null?void 0:r.id)||"",is_open_call:"true"}},{onSuccess:()=>{h.show({message:"Call berhasil dibuka",color:"green"}),m.closeAll()},onError:()=>{h.show({message:"Call gagal dibuka",color:"red"}),m.closeAll()}})}})}function D(){m.openConfirmModal({title:"Tutup Komplain",children:a.jsx("div",{className:"text-sm",children:"Apakah anda yakin untuk menutup komplain ini?"}),centered:!0,onConfirm:async()=>{await s.mutateAsync({id:r.id,data:{status:"close"}},{onSuccess:()=>{h.show({message:"Komplain berhasil ditutup",color:"green"}),m.closeAll()},onError:()=>{h.show({message:"Komplain gagal dihapus",color:"red"}),m.closeAll()}})}})}return c?a.jsx("div",{className:"mt-48",children:a.jsx(Ra,{})}):o?a.jsxs("div",{className:"mt-48 text-center",children:[a.jsx("h1",{className:"text-lg font-bold mb-2",children:"Data komplain tidak ditemukan"}),a.jsx(p,{onClick:()=>t(-1),leftSection:a.jsx(Aa,{size:14}),children:"Kembali"})]}):a.jsxs("main",{children:[a.jsx("div",{className:"mb-4 flex items-center justify-between",children:a.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Detail Komplain"})}),a.jsxs(_,{children:[a.jsxs(_.Section,{px:"lg",py:"md",withBorder:!0,children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between space-y-3 border-b border-gray-300 pb-4",children:[a.jsxs("div",{className:"flex-grow",children:[a.jsx(qe,{status:r.status,radius:"sm"}),a.jsxs("h1",{className:"font-bold text-xl text-gray-800 mt-1 mb-1",children:[r.title," #",r.id]}),a.jsxs("p",{className:"text-xs text-gray-600",children:["Dibuka oleh ",a.jsx("span",{className:"font-bold",children:r.customer.name})," pada"," ",ce(r.created_at).fromNow(),"."]})]}),a.jsxs("div",{className:"text-sm md:text-base",children:["Priority:"," ",a.jsx("span",{className:Ma("capitalize",r.priority=="high"?"text-red-600":r.priority=="medium"?"text-primary-600":"text-green-600"),children:r.priority})]})]}),a.jsxs("div",{className:"pt-4",children:[a.jsx("div",{className:"prose prose-sm mb-4",dangerouslySetInnerHTML:{__html:r.detail}}),a.jsx(Qe,{files:r.complain_files.map(({filename:w})=>w)})]}),a.jsxs("section",{className:"mt-6",children:[a.jsx("div",{className:"mb-2",children:a.jsx("h3",{className:"text-base font-bold",children:"Balasan"})}),a.jsx(Vt,{replies:r.complain_reply}),a.jsx("div",{className:"flex justify-end mt-4"})]})]}),a.jsx(_.Section,{p:"lg",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(oe,{role:["Engineer"],children:a.jsx(p,{onClick:x,leftSection:a.jsx(pt,{size:16}),color:"yellow",children:"Visit"})}),a.jsx(p,{onClick:i,leftSection:a.jsx(ht,{size:16}),children:"Reply"}),!r.user_engineer&&(l==null?void 0:l.role)!="Customer"&&a.jsx(p,{onClick:b,color:"teal",leftSection:a.jsx(gt,{size:16}),children:"Open Call"}),r.user_engineer&&(l==null?void 0:l.role)=="Customer"&&a.jsx(p,{component:k,to:`https://wa.me/${r.user_engineer.profile.phone}`,target:"_blank",color:"green",leftSection:a.jsx(ut,{size:16}),children:"Hubungi Teknisi"}),r.status!="close"&&a.jsx(p,{color:"red",onClick:D,children:"Close"}),a.jsx(p,{component:k,to:"/complain",variant:"light",color:"gray.6",bg:"gray.2",children:"Kembali"})]})})]})]})},us=()=>a.jsxs("main",{children:[a.jsx("div",{className:"mb-4 flex items-center justify-between",children:a.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Komplain"})}),a.jsx(Rt,{})]});export{us as ComplainCreate,ms as ComplainDetail,ds as Complains};
