import{i as y,a as h,u as N,q as p,j as e,L as c,B as l,m as b,n as x,r as G,f as M,h as j,k as w,U as A}from"./index-36612c22.js";import{T as C,C as u}from"./Table-d19d24ae.js";import{T as S}from"./TextEditor-887f2f57.js";import{L as P}from"./LoadingScreen-3146461c.js";import{u as L}from"./getProduct-a4d0e54c.js";import{A as v}from"./Authorization-c2323a9a.js";import{I as T}from"./IconEdit-7b57d515.js";import{I as $}from"./IconTrash-ab565fc3.js";import{I as z}from"./IconPlus-33a5a102.js";import{I as k}from"./IconArrowLeft-ace68926.js";import{F as D}from"./FileDropzone-36203138.js";import{P as F}from"./ProductSelect-5bea2719.js";import{u as I,T as g}from"./use-form-a2f7cbce.js";import"./clamp-73f6bef2.js";const m={png:"image/png",gif:"image/gif",jpeg:"image/jpeg",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif",mp4:"video/mp4",zip:"application/zip",csv:"text/csv",pdf:"application/pdf",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",exe:"application/vnd.microsoft.portable-executable"},E=[m.png,m.gif,m.jpeg,m.svg,m.webp,m.avif];async function B({params:a}){return(await h.get("/ar-service/guide-product",{params:a})).data.data}function _({config:a,params:s}={}){return y({...a,queryKey:["guide-list",s],queryFn:()=>B({params:s}),keepPreviousData:!0})}async function q({data:a}){const s=new FormData;for(const[t,n]of Object.entries(a))n&&(Array.isArray(n)?n.forEach((i,o)=>{s.append(`${t}[${o}]`,i.toString())}):n instanceof Date?s.append(t,n.toJSON()):n instanceof File?s.append(t,n,n.name):s.append(t,n.toString()));return(await h.post("/ar-service/guide-product",s)).data}function O({config:a}={}){return N(q,{...a,onSuccess:(...s)=>{p.invalidateQueries(["guide-list"]),p.invalidateQueries(["guides"]),a!=null&&a.onSuccess&&a.onSuccess(...s)}})}async function V({id:a}){return(await h.get(`/ar-service/guide-product/${a}`)).data.data}function Y({config:a,id:s}){return y({...a,queryKey:["guides",s],queryFn:()=>V({id:s})})}async function Q({id:a}){return(await h.delete(`/ar-service/guide-product/${a}`)).data}function J({config:a}={}){return N(Q,{...a,onSuccess:(...s)=>{p.invalidateQueries(["guides"]),p.invalidateQueries(["guide-list"]),a!=null&&a.onSuccess&&a.onSuccess(...s)}})}async function K({id:a,data:s}){const r=new FormData;for(const[n,i]of Object.entries(s))i&&(Array.isArray(i)?i.forEach((o,d)=>{r.append(`${n}[${d}]`,o.toString())}):i instanceof Date?r.append(n,i.toJSON()):i instanceof File?r.append(n,i,i.name):r.append(n,i.toString()));return(await h.put(`/ar-service/guide-product/${a}`,r)).data}function U({config:a}={}){return N(K,{...a,onSuccess:(...s)=>{p.invalidateQueries(["guide-list"]),p.invalidateQueries(["guides"]),a!=null&&a.onSuccess&&a.onSuccess(...s)}})}async function H({id:a}){return(await h.get(`/ar-service/guide-product/item/${a}`)).data.data}function W({config:a,id:s}){return y({...a,queryKey:["guide-item",s],queryFn:()=>H({id:s})})}const R=({productId:a})=>{const{data:s,isLoading:r,isError:t}=Y({id:a}),n=J();function i(d,f){return(new DOMParser().parseFromString(d,"text/html").body.textContent||"").split(/\s+/).slice(0,f).join(" ")}function o(d){return()=>{b.openConfirmModal({modalId:"guide-delete",title:"Hapus Panduan",children:e.jsx("div",{className:"text-sm",children:"Apakah Anda yakin untuk menghapus panduan ini?"}),closeOnConfirm:!1,centered:!0,onConfirm:async()=>{await n.mutateAsync({id:d.id},{onSuccess:()=>{x.show({color:"green",message:"Panduan berhasil dihapus"}),b.close("guide-delete")},onError:()=>{x.show({color:"red",message:"Panduan gagal dihapus"}),b.close("guide-delete")}})}})}}return r||t?e.jsx("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array(4).fill(0).map((d,f)=>e.jsxs("div",{className:"w-full bg-white rounded-lg overflow-hidden",children:[e.jsx("div",{className:"w-full aspect-video bg-gray-200 animate-pulse"}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-5 w-20 bg-gray-200 animate-pulse rounded-lg mt-1 mb-2"}),e.jsx("div",{className:"bg-gray-200 animate-pulse h-5 w-full rounded-md mb-2"}),e.jsx("div",{className:"bg-gray-200 animate-pulse h-5 w-1/2 rounded-md mb-2"}),e.jsx("div",{className:"h-4 w-12 bg-gray-200 rounded-md animate-pulse"}),e.jsx("div",{className:"space-y-2 mt-2",children:e.jsx("div",{className:"bg-gray-200 w-full h-7 rounded-md"})})]})]},`skp_${f}`))}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:s.guide.map(d=>e.jsxs("div",{className:"w-full bg-white rounded-lg overflow-hidden",children:[e.jsx(c,{to:`/guide/${d.id}`,children:e.jsx("div",{className:"w-full aspect-video bg-gray-200 relative",children:d.image&&e.jsx("img",{src:d.image,alt:"",className:"absolute inset-0 w-full h-full object-cover object-center"})})}),e.jsxs("div",{className:"p-4",children:[e.jsxs(c,{to:`/guide/${d.id}`,children:[e.jsx("h2",{className:"line-clamp-2 text-base font-bold mb-1 hover:underline",children:d.title}),e.jsx("p",{className:"text-sm line-clamp-2 text-gray-600",children:i(d.description,15)})]}),e.jsx(v,{role:["Admin","Superadmin"],children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsx(l,{component:c,to:`/guide/${d.id}/update`,variant:"light",leftSection:e.jsx(T,{size:16}),fullWidth:!0,size:"xs",children:"Edit"}),e.jsx(l,{color:"red",variant:"light",leftSection:e.jsx($,{size:16}),fullWidth:!0,size:"xs",onClick:o(d),children:"Hapus"})]})})]})]},d.id))}),s.guide.length==0&&e.jsxs("div",{className:"col-span-12 flex flex-col items-center justify-center py-24 mx-auto max-w-md",children:[e.jsxs("p",{className:"text-lg font-bold mb-4 text-center",children:["Belum ada panduan untuk produk ini",e.jsx(v,{role:["Admin","Superadmin"],children:", tekan tombol dibawah untuk menambahkan"})]}),e.jsx(v,{role:["Admin","Superadmin"],children:e.jsx(l,{component:c,to:`/guide/create?product=${s.id}`,leftSection:e.jsx(z,{size:16}),children:"Tambah Panduan"})})]})]})},X={page:1,limit:10,search:""},Z=({toolbar:a})=>{const[s,r]=G.useState(X),{data:t,isLoading:n}=_({params:s});return e.jsx(C,{title:"Tabel Data Panduan",toolbar:a,header:["#","Produk","Diperbaharui",""],items:t==null?void 0:t.data,onPageChange:i=>{r({...s,page:i})},loading:n,metadata:{count:(t==null?void 0:t.data.length)||10,limit:s.limit||10,page:s.page||10,total:(t==null?void 0:t.total)||10},renderItem:(i,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:(s.limit??5)*((s.page??0)-1)+o+1}),e.jsx("td",{children:i.name}),e.jsx("td",{children:M(i.updatedAt).format("D MMMM YYYY H:mm")}),e.jsx("td",{children:e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(l,{component:c,to:`/guide/product/${i.id}`,size:"xs",children:"Lihat Panduan"})})})]},i.id)})},ee=({product:a})=>{const s=O(),r=j(),t=I({initialValues:{product_id:a,title:"",image:void 0,description:"",video:""}}),n=t.onSubmit(async i=>{await s.mutateAsync({data:i},{onSuccess:()=>{x.show({color:"green",message:"Panduan berhasil dibuat"}),r("/guide")},onError:({response:o})=>{t.setErrors((o==null?void 0:o.data).errors),x.show({color:"red",message:"Panduan gagal dibuat"})}})});return e.jsxs(u,{component:"form",onSubmit:n,shadow:"lg",children:[e.jsx(u.Section,{p:"lg",withBorder:!0,children:e.jsx("h2",{className:"font-semibold text-base",children:"Tambah Data Panduan"})}),e.jsx(u.Section,{p:"lg",pt:"xs",withBorder:!0,children:e.jsxs("div",{className:"grid grid-cols-12 gap-x-6 gap-y-4 border-b border-gray-300",children:[e.jsx(F,{...t.getInputProps("product_id"),label:"Produk",placeholder:"Pilih Produk",className:"col-span-12 md:col-span-12",limit:20,nothingFoundMessage:"Data tidak ditemukan"}),e.jsx(g,{...t.getInputProps("title"),label:"Judul",placeholder:"Masukan Judul",className:"col-span-12"}),e.jsx(g,{...t.getInputProps("video"),label:"Link Video Youtube (Opsional)",placeholder:"https://",className:"col-span-12"}),e.jsx("div",{className:"col-span-12",children:e.jsx(D,{label:"Foto Sampul",value:t.values.image,onDrop:i=>{t.setFieldValue("image",i[0])},accept:E,maxSize:5*1024**2,maxFiles:1,multiple:!1})}),e.jsx("div",{className:"col-span-12",children:e.jsx(S,{value:t.values.description,onChange:i=>t.setFieldValue("description",i)})})]})}),e.jsxs(u.Section,{p:"lg",withBorder:!0,className:"flex justify-start items-center space-x-4",children:[e.jsx(l,{type:"submit",loading:s.isLoading,children:"Simpan"}),e.jsx(l,{component:c,to:"/guide",variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"})]})]})},ae=({guide:a})=>{const s=U(),r=j(),t=I({initialValues:{product_id:a.product_id,title:a.title,image:void 0,description:a.description,video:a.video||void 0}}),n=t.onSubmit(async i=>{await s.mutateAsync({id:a.id,data:i},{onSuccess:()=>{x.show({color:"green",message:"Panduan berhasil dirubah"}),r("/guide")},onError:({response:o})=>{t.setErrors((o==null?void 0:o.data).errors),x.show({color:"red",message:"Panduan gagal dirubah"})}})});return e.jsxs(u,{component:"form",onSubmit:n,shadow:"lg",children:[e.jsx(u.Section,{p:"lg",withBorder:!0,children:e.jsx("h2",{className:"font-semibold text-base",children:"Edit Data Panduan"})}),e.jsx(u.Section,{p:"lg",pt:"xs",withBorder:!0,children:e.jsxs("div",{className:"grid grid-cols-12 gap-x-6 gap-y-4 border-b border-gray-300",children:[e.jsx(F,{...t.getInputProps("product_id"),label:"Produk",placeholder:"Pilih Produk",className:"col-span-12 md:col-span-12",limit:20,nothingFoundMessage:"Data tidak ditemukan"}),e.jsx(g,{...t.getInputProps("title"),label:"Judul",placeholder:"Masukan Judul",className:"col-span-12"}),e.jsx(g,{...t.getInputProps("video"),label:"Link Video Youtube (Opsional)",placeholder:"https://",className:"col-span-12"}),e.jsx("div",{className:"col-span-12",children:e.jsx(D,{label:"Foto Sampul",value:t.values.image,onDrop:i=>{t.setFieldValue("image",i[0])},accept:E,maxSize:5*1024**2,maxFiles:1,multiple:!1})}),e.jsx("div",{className:"col-span-12",children:e.jsx(S,{value:t.values.description,onChange:i=>t.setFieldValue("description",i)})})]})}),e.jsxs(u.Section,{p:"lg",withBorder:!0,className:"flex justify-start items-center space-x-4",children:[e.jsx(l,{type:"submit",loading:s.isLoading,children:"Simpan"}),e.jsx(l,{component:c,to:"/guide",variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"})]})]})},ve=()=>e.jsxs("main",{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Panduan"}),e.jsx(l,{component:c,to:"/guide/create",children:"Tambah"})]}),e.jsx("section",{className:"mb-8",children:e.jsx(Z,{})})]}),ye=()=>{const{id:a}=w(),s=j(),{data:r,isLoading:t,isError:n}=L({id:a});return t?e.jsx("div",{className:"mt-48",children:e.jsx(P,{})}):n?e.jsxs("div",{className:"mt-48 text-center",children:[e.jsx("h1",{className:"text-lg font-bold mb-2",children:"Produk tidak ditemukan"}),e.jsx(l,{onClick:()=>s(-1),leftSection:e.jsx(k,{size:14}),children:"Kembali"})]}):e.jsxs("main",{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Panduan Berdasarkan Produk"}),e.jsx(l,{component:c,to:`/guide/create?product=${r.id}`,children:"Tambah"})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:r.name}),e.jsx("p",{className:"text-sm text-primary-600",children:r.brand.name})]}),e.jsx(R,{productId:r.id})]})]})},Ne=()=>{const[a]=A();return e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Panduan"})}),e.jsx(ee,{product:a.get("product")||void 0})]})},we=()=>{const{id:a}=w(),{data:s,isLoading:r,isError:t}=W({id:a}),n=j();return r?e.jsx("div",{className:"mt-48",children:e.jsx(P,{})}):t?e.jsxs("div",{className:"mt-48 text-center",children:[e.jsx("h1",{className:"text-lg font-bold mb-2",children:"Produk tidak ditemukan"}),e.jsx(l,{onClick:()=>n(-1),leftSection:e.jsx(k,{size:14}),children:"Kembali"})]}):e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Panduan"})}),e.jsx(ae,{guide:s})]})},Se=()=>e.jsx("div",{});export{Ne as GuideCreate,Se as GuideDetail,we as GuideUpdate,ve as Guides,ye as ProductGuides};
