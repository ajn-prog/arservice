import{r as p,T as H,o as ae,p as se,G as we,R as k,t as ke,F as Pe,E as Se,v as Y,w as _e,x as Ce,z as Ie,N as Q,c as te,u as re,q as R,a as A,k as ne,U as q,j as e,h as I,m as b,P as _,n as $,V as Oe,B as y,g as Ee,b as Ae,i as ie,L as Me,W as Te}from"./index-83f02462.js";import{Y as Ja,X as Ua}from"./index-83f02462.js";import{a as oe,T as C}from"./TextInput-8700b334.js";import{I as ze,a as Be,b as Re,R as z}from"./Radio-e7083dfb.js";import{a as $e,I as Fe,L as qe,C as De}from"./LoadingScreen-1d872a53.js";import{N as F,T as Ve}from"./NumberInput-c1d48a02.js";import{I as Ge}from"./IconPlus-559040c7.js";import{T as Le}from"./Table-7bf1ad96.js";import{u as D}from"./use-form-b88078fc.js";import{I as Ke}from"./IconEye-533ad2da.js";import{I as Je}from"./IconEdit-75466a24.js";import"./clamp-73f6bef2.js";function Ue(a,s){try{return JSON.stringify(a)}catch{throw new Error(`@mantine/hooks ${s}: Failed to serialize the value`)}}function We(a){try{return a&&JSON.parse(a)}catch{return a}}function He(a){return{getItem:o=>{try{return window[a].getItem(o)}catch{return console.warn("use-local-storage: Failed to get value from storage, localStorage is blocked"),null}},setItem:(o,l)=>{try{window[a].setItem(o,l)}catch{console.warn("use-local-storage: Failed to set value to storage, localStorage is blocked")}},removeItem:o=>{try{window[a].removeItem(o)}catch{console.warn("use-local-storage: Failed to remove value from storage, localStorage is blocked")}}}}function Ye(a,s){const t=a==="localStorage"?"mantine-local-storage":"mantine-session-storage",{getItem:r,setItem:o,removeItem:l}=He(a);return function({key:i,defaultValue:c,getInitialValueInEffect:f=!0,deserialize:h=We,serialize:j=d=>Ue(d,s)}){const d=p.useCallback(u=>{let m;try{m=typeof window>"u"||!(a in window)||window[a]===null||!!u}catch{m=!0}if(m)return c;const w=r(i);return w!==null?h(w):c},[i,c]),[x,v]=p.useState(d(f)),N=p.useCallback(u=>{u instanceof Function?v(m=>{const w=u(m);return o(i,j(w)),window.dispatchEvent(new CustomEvent(t,{detail:{key:i,value:u(m)}})),w}):(o(i,j(u)),window.dispatchEvent(new CustomEvent(t,{detail:{key:i,value:u}})),v(u))},[i]),G=p.useCallback(()=>{l(i),window.dispatchEvent(new CustomEvent(t,{detail:{key:i,value:c}}))},[]);return H("storage",u=>{var m;u.storageArea===window[a]&&u.key===i&&v(h((m=u.newValue)!=null?m:void 0))}),H(t,u=>{u.detail.key===i&&v(u.detail.value)}),p.useEffect(()=>{c!==void 0&&x===void 0&&N(c)},[c,x,N]),p.useEffect(()=>{f&&v(d())},[]),[x===void 0?c:x,N,G]}}function le(a){return Ye("localStorage","use-local-storage")(a)}const ce=p.createContext(null),Qe=ce.Provider,Xe=()=>p.useContext(ce);var Ze=Object.defineProperty,ea=Object.defineProperties,aa=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertySymbols,de=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,X=(a,s,t)=>s in a?Ze(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t,Z=(a,s)=>{for(var t in s||(s={}))de.call(s,t)&&X(a,t,s[t]);if(O)for(var t of O(s))ue.call(s,t)&&X(a,t,s[t]);return a},sa=(a,s)=>ea(a,aa(s)),ta=(a,s)=>{var t={};for(var r in a)de.call(a,r)&&s.indexOf(r)<0&&(t[r]=a[r]);if(a!=null&&O)for(var r of O(a))s.indexOf(r)<0&&ue.call(a,r)&&(t[r]=a[r]);return t};const ra={},V=ae((a,s)=>{const t=se("CheckboxGroup",ra,a),{value:r,defaultValue:o,onChange:l,size:n,wrapperProps:i,children:c}=t,f=ta(t,["value","defaultValue","onChange","size","wrapperProps","children"]),[h,j]=we({value:r,defaultValue:o,finalValue:[],onChange:l}),d=x=>{const v=x.currentTarget.value;j(h.includes(v)?h.filter(N=>N!==v):[...h,v])};return k.createElement(Qe,{value:{value:h,onChange:d,size:n}},k.createElement(oe.Wrapper,sa(Z(Z({size:n,ref:s},i),f),{labelElement:"div",__staticSelector:"CheckboxGroup"}),k.createElement(ze,{role:"group"},c)))});V.classes=oe.Wrapper.classes;V.displayName="@mantine/core/CheckboxGroup";var na={root:"m-bf2d988c",inner:"m-26062bec",input:"m-26063560",icon:"m-bf295423"};const me=na;var ia=Object.defineProperty,oa=Object.defineProperties,la=Object.getOwnPropertyDescriptors,E=Object.getOwnPropertySymbols,pe=Object.prototype.hasOwnProperty,he=Object.prototype.propertyIsEnumerable,ee=(a,s,t)=>s in a?ia(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t,g=(a,s)=>{for(var t in s||(s={}))pe.call(s,t)&&ee(a,t,s[t]);if(E)for(var t of E(s))he.call(s,t)&&ee(a,t,s[t]);return a},B=(a,s)=>oa(a,la(s)),ca=(a,s)=>{var t={};for(var r in a)pe.call(a,r)&&s.indexOf(r)<0&&(t[r]=a[r]);if(a!=null&&E)for(var r of E(a))s.indexOf(r)<0&&he.call(a,r)&&(t[r]=a[r]);return t};const da={labelPosition:"right",icon:$e},ua=_e((a,{radius:s,color:t,size:r,iconColor:o})=>({root:{"--checkbox-size":Ce(r,"checkbox-size"),"--checkbox-radius":s===void 0?void 0:Ie(s),"--checkbox-color":t?Q(t,a):void 0,"--checkbox-icon-color":o?Q(o,a):void 0}})),M=ae((a,s)=>{const t=se("Checkbox",da,a),r=t,{classNames:o,className:l,style:n,styles:i,unstyled:c,vars:f,color:h,label:j,id:d,size:x,radius:v,wrapperProps:N,children:G,checked:u,labelPosition:m,description:w,error:T,disabled:L,variant:ve,indeterminate:K,icon:ge,rootRef:fe,iconColor:Ia}=r,je=ca(r,["classNames","className","style","styles","unstyled","vars","color","label","id","size","radius","wrapperProps","children","checked","labelPosition","description","error","disabled","variant","indeterminate","icon","rootRef","iconColor"]),P=Xe(),be=x||(P==null?void 0:P.size),ye=ge,S=ke({name:"Checkbox",props:t,classes:me,className:l,style:n,classNames:o,styles:i,unstyled:c,vars:f,varsResolver:ua}),{styleProps:Ne,rest:J}=Pe(je),U=Se(d),W=P?{checked:P.value.includes(J.value),onChange:P.onChange}:{};return k.createElement(Be,g(g(B(g({},S("root")),{__staticSelector:"Checkbox",__stylesApiProps:t,id:U,size:be,labelPosition:m,label:j,description:w,error:T,disabled:L,classNames:o,styles:i,unstyled:c,"data-checked":W.checked||u||void 0,variant:ve,ref:fe}),Ne),N),k.createElement(Y,B(g({},S("inner")),{mod:{"data-label-position":m}}),k.createElement(Y,B(g(g(g({component:"input",id:U,ref:s,checked:u,disabled:L,mod:{error:!!T,indeterminate:K}},S("input",{focusable:!0})),J),W),{type:"checkbox"})),k.createElement(ye,g({indeterminate:K},S("icon")))))});M.classes=g(g({},me),Re);M.displayName="@mantine/core/Checkbox";M.Group=V;var ma=te("basket-off","IconBasketOff",[["path",{d:"M17 10l-2 -6",key:"svg-0"}],["path",{d:"M7 10l.75 -2.252m1.001 -3.002l.249 -.746",key:"svg-1"}],["path",{d:"M12 8h7a2 2 0 0 1 1.977 2.304c-.442 2.516 -.756 4.438 -.977 5.696m-1.01 3.003a2.997 2.997 0 0 1 -2.234 .997h-9.512a3 3 0 0 1 -2.965 -2.544l-1.255 -7.152a2 2 0 0 1 1.977 -2.304h2.999",key:"svg-2"}],["path",{d:"M12 12a2 2 0 1 0 2 2",key:"svg-3"}],["path",{d:"M3 3l18 18",key:"svg-4"}]]),pa=te("minus","IconMinus",[["path",{d:"M5 12l14 0",key:"svg-0"}]]);async function ha({data:a}){const s=new FormData;for(const[r,o]of Object.entries(a))o&&(Array.isArray(o)?o.forEach((l,n)=>{s.append(`${r}[${n}]`,l.toString())}):s.append(r,o.toString()));return(await A.post("/ar-service/order",s)).data}function xa({config:a}={}){return re(ha,{...a,onSuccess:(...s)=>{R.invalidateQueries(["carts"]),a!=null&&a.onSuccess&&a.onSuccess(...s)}})}async function va({params:a}){return(await A.get("/ar-service/tender",{params:a})).data.data}function ga({config:a,params:s}={}){return ne({...a,queryKey:["tenders",s],queryFn:()=>va({params:s}),keepPreviousData:!0})}async function fa({id:a,data:s}){return s.status=="rejected"&&(s.contract_value=void 0,s.delivery_cost=void 0),(await A.put(`/ar-service/tender/${a}`,s)).data}function ja({config:a}={}){return re(fa,{...a,onSuccess:(...s)=>{R.invalidateQueries(["tenders"]),R.invalidateQueries(["tender",s[1].id]),a!=null&&a.onSuccess&&a.onSuccess(...s)}})}const ba={main:"Unit",accessories:"Accessories",preventive:"Service/Sparepart"},xe=({carts:a,selected:s,onChange:t,readOnly:r=!1})=>{const{updateCart:o}=q();async function l(i,c){if(c==0)return b.openConfirmModal({title:"Hapus Keranjang",children:e.jsx("div",{className:"text-sm",children:"Apakah Anda yakin untuk menghapus keranjang?"}),onConfirm:async()=>{await o(i,c)}});await o(i,c)}function n(i){return()=>s.includes(i)?t(s.filter(c=>c!==i)):t([...s,i])}return e.jsx("div",{className:"divide-y divide-gray-300",children:a.map(i=>e.jsxs("div",{className:"bg-white w-full px-4 py-4 flex items-center",children:[e.jsxs("div",{className:"flex-grow flex items-center space-x-4",children:[!r&&e.jsx("div",{children:e.jsx(M,{checked:s.includes(i.product_id),onChange:n(i.product_id)})}),e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-md flex-shrink-0"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-primary-600 text-sm",children:ba[i.product.type]}),e.jsx("div",{className:"text-gray-900 font-semibold",children:i.product.name}),e.jsxs("div",{className:"text-primary-600 text-sm",children:[i.product.brand.name,", ",i.product.category.name]})]})]}),e.jsx("div",{className:"flex-shrink-0",children:r?e.jsxs("div",{className:"text-sm text-primary-600",children:["Jumlah (",e.jsx("strong",{children:i.quantity}),")"]}):e.jsxs("div",{className:"flex items-center justify-center flex-shrink-0",children:[e.jsx(I,{onClick:()=>l(i.id,i.quantity-1),size:20,variant:"outline",color:"primary",radius:"100%",children:e.jsx(pa,{className:"p-px"})}),e.jsx(F,{hideControls:!0,min:0,step:1,variant:"unstyled",readOnly:!0,value:i.quantity,className:"[&_input]:w-8 [&_input]:text-center border-b border-gray-200 px-2"}),e.jsx(I,{onClick:()=>l(i.id,i.quantity+1),size:20,variant:"outline",color:"primary",radius:"100%",children:e.jsx(Ge,{className:"p-px"})})]})})]},i.id))})},ya=({status:a})=>{switch(a){case"pending":return e.jsx(_,{variant:"light",color:"gray",children:"Menunggu"});case"approved":return e.jsx(_,{variant:"light",color:"green",children:"Diterima"});case"rejected":return e.jsx(_,{variant:"light",color:"red",children:"Ditolak"});default:return e.jsx(_,{variant:"light",color:"gray",children:"Pending"})}},Na=({tender:a,onCancel:s,onSuccess:t})=>{const{mutateAsync:r,isLoading:o}=ja(),l=D({initialValues:{status:"rejected",contract_value:0,delivery_cost:0}}),n=l.onSubmit(async i=>{await r({id:a.id,data:i},{onError({response:c}){l.setErrors((c==null?void 0:c.data).errors)},onSuccess(){$.show({message:"Penawaran berhasil diubah",color:"green",icon:e.jsx(Fe,{})}),t&&t()}})});return e.jsxs("form",{className:"relative",onSubmit:n,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z.Group,{...l.getInputProps("status"),label:"Status Penawaran",children:e.jsxs(Oe,{mt:"xs",children:[e.jsx(z,{value:"approved",label:"Terima"}),e.jsx(z,{value:"rejected",label:"Tolak"})]})}),l.values.status=="approved"&&e.jsxs(e.Fragment,{children:[e.jsx(F,{...l.getInputProps("contract_value"),label:"Nilai Kontrak",placeholder:"Masukan nilai kontrak",leftSection:e.jsx("span",{className:"text-xs",children:"Rp."}),decimalSeparator:",",thousandSeparator:".",hideControls:!0}),e.jsx(F,{...l.getInputProps("delivery_cost"),label:"Ongkos Kirim",placeholder:"Masukan ongkos kirim",leftSection:e.jsx("span",{className:"text-xs",children:"Rp."}),decimalSeparator:",",thousandSeparator:".",hideControls:!0})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-6",children:[e.jsx(y,{type:"submit",loading:o,children:"Konfirmasi"}),e.jsx(y,{type:"button",variant:"default",onClick:()=>{s&&s()},loading:o,children:"Batal"})]})]})},wa={page:1,limit:10,search:""},ka={main:"Unit",accessories:"Accessories",preventive:"Service/Sparepart"},Pa=({toolbar:a})=>{const[s,t]=p.useState(wa),{data:r,isLoading:o}=ga({params:s});function l(n){return()=>{b.open({title:"Konfirmasi Penawaran",children:e.jsx(Na,{tender:n,onSuccess:()=>b.closeAll(),onCancel:()=>b.closeAll()})})}}return e.jsx(Le,{title:"Tabel Data Penawaran",toolbar:a,header:["Produk","PIC","Status","Diperbaharui",""],items:r==null?void 0:r.data,onPageChange:n=>{t({...s,page:n})},loading:o,metadata:{count:(r==null?void 0:r.data.length)||10,limit:s.limit||10,page:s.page||10,total:(r==null?void 0:r.total)||10},renderItem:n=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{className:"text-xs text-primary-600",children:ka[n.details[0].product.type]}),e.jsx("div",{className:"text-sm text-gray-900",children:n.details[0].product.name}),n.details.length>1&&e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["+ ",n.details.length-1," produk lainnya"]})]}),e.jsxs("td",{children:[e.jsxs("div",{className:"text-gray-900",children:[n.recipient_name," / ",n.recipient_phone]}),e.jsx("div",{className:"text-xs text-gray-600",children:n.recipient_position})]}),e.jsx("td",{children:e.jsx(ya,{status:n.status})}),e.jsx("td",{children:Ee(n.updatedAt).format("D MMMM YYYY H:mm")}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{variant:"subtle",title:"Detail Penawaran",color:"gray",radius:"lg",children:e.jsx(Ke,{size:18})}),e.jsx(Ae,{role:["Superadmin","Admin"],children:n.status=="pending"&&e.jsx(I,{onClick:l(n),variant:"subtle",title:"Hapus Penawaran",color:"primary",radius:"lg",children:e.jsx(Je,{size:18})})})]})})]},n.id)})},Sa=({onSubmit:a,onCancel:s})=>{const t=D({initialValues:{phone:"",address:""}}),r=t.onSubmit(async()=>{a(t.values),t.reset()});return e.jsxs("form",{onSubmit:r,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{...t.getInputProps("phone"),required:!0,label:"No Telepon",placeholder:"Masukan No Telepon"}),e.jsx(Ve,{...t.getInputProps("address"),required:!0,label:"Alamat",placeholder:"Masukan Alamat"})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsx(y,{type:"submit",children:"Simpan"}),e.jsx(y,{type:"button",variant:"default",onClick:s,children:"Batal"})]})]})},Da=()=>{const{carts:a}=q(),s=ie(),[t,r]=le({key:"selected-cart",defaultValue:[]}),o=p.useMemo(()=>a.filter(({product_id:n})=>t.includes(n)).reduce((n,i)=>n+i.quantity,0),[a,t]);function l(){r(a.filter(({product_id:n})=>t.includes(n)).map(({product_id:n})=>n)),s("/cart/checkout")}return e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Keranjang"})}),e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-12 lg:col-span-8 rounded-md overflow-hidden",children:[e.jsx(xe,{carts:a,selected:t,onChange:n=>r(n)}),a.length==0&&e.jsxs("div",{className:"bg-white rounded-md w-full p-12 flex flex-col items-center justify-center text-center",children:[e.jsx(ma,{size:42,stroke:1.2,className:"text-gray-600 mb-2"}),e.jsx("h3",{className:"text-lg font-bold",children:"Keranjang Kosong"}),e.jsx("p",{className:"mb-4 text-gray-600",children:"Anda belum pernah menambahkan produk kedalam keranjang"}),e.jsx(y,{component:Me,to:"/product",leftSection:e.jsx(Te,{size:17}),children:"Lihat Katalog"})]})]}),e.jsx("div",{className:"col-span-12 lg:col-span-4",children:e.jsxs("div",{className:"bg-white w-full p-4 rounded-md",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[e.jsx("h3",{className:"text-base text-gray-800 font-medium mb-2",children:"Ringkasan Belanja"}),e.jsxs("p",{className:"text-primary-600 text-sm",children:["Jumlah Barang (",o,")"]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(y,{onClick:l,fullWidth:!0,disabled:o==0,children:"Beli"})})]})})]})]})};async function _a(){return(await A.get("/ar-service/profile/biodata")).data.data}function Ca({config:a}={}){return ne({...a,queryKey:["biodata"],queryFn:()=>_a()})}const Va=()=>{const{carts:a}=q(),s=ie(),{data:t,isLoading:r,isError:o}=Ca(),l=xa(),n=D({initialValues:{name:"",carts:[],address:"",kecamatan_id:void 0,phone:"",position:""}}),[i,c]=le({key:"selected-cart",defaultValue:[]}),f=n.onSubmit(async d=>{b.openConfirmModal({title:"Checkout",children:e.jsx("div",{className:"text-sm",children:"Apakah data yang Anda masukan sudah benar?"}),onConfirm:async()=>{await l.mutateAsync({data:{...d,carts:i}},{onSuccess:()=>{$.show({message:"Penawaran berhasil dibuat",color:"green"}),c([]),s("/tender")},onError:()=>{$.show({message:"Penawaran gagal dibuat",color:"green"})}})}})});p.useEffect(()=>{t&&n.setValues({...n.values,address:t.address,kecamatan_id:t.kecamatan_id,phone:t.phone_number})},[t]);const h=p.useMemo(()=>a.filter(({product_id:d})=>i.includes(d)).reduce((d,x)=>d+x.quantity,0),[a,i]);function j(){b.open({modalId:"address-modal",title:"Ubah Alamat",centered:!0,children:e.jsx(Sa,{onCancel:()=>b.close("address-modal"),onSubmit:d=>{n.setFieldValue("address",d.address),n.setFieldValue("phone",d.phone),b.close("address-modal")}})})}return r||o?e.jsx("div",{className:"my-24",children:e.jsx(qe,{})}):e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Checkout"})}),e.jsxs("form",{onSubmit:f,className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-12 md:col-span-8 lg:col-span-9 space-y-6",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs(De,{p:"lg",children:[e.jsx("div",{className:"border-b border-gray-200 pb-2",children:e.jsx("h2",{className:"text-base text-gray-900 font-medium",children:"Penanggung Jawab"})}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 py-2",children:[e.jsx(C,{...n.getInputProps("name"),required:!0,label:"Nama PIC",placeholder:"Ex :  Sarimin"}),e.jsx(C,{...n.getInputProps("position"),required:!0,label:"Jabatan",placeholder:"Ex : Direktur"}),e.jsx(C,{label:"Nomor HP",required:!0,placeholder:"Ex : 085752140606"})]}),e.jsx("div",{className:"border-b border-gray-200 pb-2 mt-4",children:e.jsx("h2",{className:"text-base text-gray-900 font-medium",children:"Alamat Pengiriman"})}),e.jsxs("div",{className:"pt-2",children:[e.jsx("div",{className:"text-primary-600 font-bold mb-1",children:t.name}),e.jsx("div",{className:"font-bold",children:n.values.phone}),e.jsx("div",{className:"text-sm text-gray-600",children:n.values.address}),e.jsx(y,{onClick:j,variant:"outline",className:"mt-4",size:"xs",children:"Ganti Alamat Lain"})]})]})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Pesanan"}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(xe,{carts:a.filter(({product_id:d})=>i.includes(d)),selected:i,onChange:d=>c(d),readOnly:!0})})]})]}),e.jsx("div",{className:"col-span-12 md:col-span-4 lg:col-span-3",children:e.jsxs("div",{className:"bg-white w-full p-4 rounded-md",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[e.jsx("h3",{className:"text-base text-gray-800 font-medium mb-2",children:"Ringkasan Belanja"}),e.jsxs("p",{className:"text-primary-600 text-sm",children:["Jumlah Barang (",h,")"]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(y,{type:"submit",fullWidth:!0,disabled:i.length==0,loading:l.isLoading,children:"Penawaran"})})]})})]})]})},Ga=()=>e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Penawaran"})}),e.jsx("section",{className:"mb-8",children:e.jsx(Pa,{})})]});export{Sa as AddressForm,xe as CartList,Ja as CartMenu,Ua as CartProvider,Da as Carts,Va as Checkout,Pa as TenderTable,Ga as Tenders,q as useCart};
