import{u as P,q as j,a as v,e as B,r as S,j as e,i as F,b as L,f as w,L as I,t as N,n as g,I as H,p as k,B as b,v as Q}from"./index-5e1e6915.js";import{T as U}from"./Table-924f240d.js";import{u as q}from"./AgencySelect-b4813168.js";import{A as Ce}from"./AgencySelect-b4813168.js";import{I as z}from"./IconEdit-703ef070.js";import{I as Y}from"./IconTrash-c72e9656.js";import{I as $,u as O,L as V}from"./LoadingScreen-473e5291.js";import{T as c}from"./TextInput-63e4842a.js";import{I as J}from"./IconSearch-8f2b9705.js";import{S as A,C as K,O as C,P as E,R as D,D as M}from"./index-780a9547.js";import{u as _}from"./use-form-55e97180.js";import{C as d,S as x}from"./Select-7be37b05.js";import{N as R}from"./NumberInput-32e06852.js";import{P as T}from"./PasswordInput-2a1a0429.js";import{I as W}from"./IconArrowLeft-2b1f04f8.js";import"./ScrollArea-7b98c217.js";import"./clamp-73f6bef2.js";async function X({data:a}){return(await v.post("/ar-service/customer",a)).data}function G({config:a}={}){return P(X,{...a,onSuccess:(...n)=>{j.invalidateQueries(["agencies"]),a!=null&&a.onSuccess&&a.onSuccess(...n)}})}async function Z({id:a}){return(await v.get(`/ar-service/customer/${a}`)).data.data}function ee({config:a,id:n}){return B({...a,queryKey:["agency",n],queryFn:()=>Z({id:n})})}async function ae({id:a,data:n}){return(await v.put(`/ar-service/customer/${a}`,n)).data}function se({config:a}={}){return P(ae,{...a,onSuccess:(...n)=>{j.invalidateQueries(["agencies"]),j.invalidateQueries(["agency"]),a!=null&&a.onSuccess&&a.onSuccess(...n)}})}async function te({id:a}){return(await v.delete(`/ar-service/customer/${a}`)).data}function ne({config:a}={}){return P(te,{...a,onSuccess:(...n)=>{j.invalidateQueries(["agencies"]),a!=null&&a.onSuccess&&a.onSuccess(...n)}})}const le={page:1,limit:10,search:""},re=({toolbar:a,...n})=>{const[l,s]=S.useState(le),{data:t,isLoading:m}=q({params:{...l,...n}}),h=ne();function p(r){return()=>{N.openConfirmModal({title:"Hapus Instansi",children:e.jsx("div",{className:"text-sm",children:"Apakah anda yakin untuk menghapus instansi ini?"}),centered:!0,onConfirm:async()=>{await h.mutateAsync({id:r},{onSuccess:()=>{g.show({message:"Instansi berhasil dihapus",color:"green",icon:e.jsx($,{})}),N.closeAll()},onError:()=>{g.show({message:"Instansi tidak bisa dihapus",color:"red",icon:e.jsx(H,{})}),N.closeAll()}})}})}}return e.jsx(U,{title:"Tabel Data Instansi",toolbar:a,header:["Instansi","Kelas","Alamat","Provinsi/Area","Created At",""],items:t==null?void 0:t.data,onPageChange:r=>{s({...l,page:r})},loading:m,metadata:{count:(t==null?void 0:t.data.length)||10,limit:l.limit||10,page:l.page||10,total:(t==null?void 0:t.total)||10},renderItem:r=>{var i,o;return e.jsxs("tr",{children:[e.jsx("td",{children:r.name}),e.jsx("td",{children:r.classes}),e.jsx("td",{children:r.address}),e.jsx("td",{children:((o=(i=r.kecamatan.kabupaten)==null?void 0:i.province)==null?void 0:o.name)??"-"}),e.jsx("td",{children:F(r.created_at).format("D MMMM YYYY H:mm")}),e.jsx("td",{children:e.jsx(L,{role:["Superadmin"],children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{variant:"subtle",component:I,to:`/agency/${r.id}`,title:"Update Instansi",color:"primary",radius:"lg",children:e.jsx(z,{size:18})}),e.jsx(w,{variant:"subtle",onClick:p(r.id),title:"Hapus Instansi",color:"red",radius:"lg",children:e.jsx(Y,{size:18})})]})})})]},r.id)}})},ie=()=>{var h,p,r;const a=k(),{mutateAsync:n}=G(),l=_({initialValues:{name:"",address:"",email:"",classes:void 0,hospital_code:void 0,kecamatan_id:void 0,latitude:0,longitude:0,owner:"",password:"",phone_number:"",sector:void 0}}),[s,t]=S.useState({province:null,district:null,regency:null}),m=l.onSubmit(async i=>{await n({data:{...i,kecamatan_id:s.district||void 0}},{onSuccess:()=>{g.show({color:"green",message:"Instansi berhasil dibuat"}),a("/agency")},onError:({response:o})=>{l.setErrors((o==null?void 0:o.data).errors),g.show({color:"red",message:"Instansi gagal dibuat"})}})});return e.jsxs(d,{component:"form",onSubmit:m,shadow:"lg",children:[e.jsx(d.Section,{p:"lg",withBorder:!0,children:e.jsx("h2",{className:"font-semibold text-base",children:"Tambah Data Instansi"})}),e.jsxs(d.Section,{p:"lg",pt:"xs",withBorder:!0,children:[e.jsxs("div",{className:"pb-6 grid grid-cols-12 gap-x-6 gap-y-4 border-b border-gray-300",children:[e.jsx(c,{...l.getInputProps("hospital_code"),label:"Kode RS",placeholder:"Ex : 20392",className:"col-span-12 md:col-span-4"}),e.jsx(c,{...l.getInputProps("name"),label:"Nama Instansi",placeholder:"Ex : RS Umum Daerah H. Sahudin Kutacane. . .",className:"col-span-12 md:col-span-8"}),e.jsx(x,{...l.getInputProps("sector"),label:"Sektor",placeholder:"Pilih Sektor",data:A,className:"col-span-12 md:col-span-4"}),e.jsx(x,{...l.getInputProps("classes"),label:"Kelas",placeholder:"Pilih Kelas",data:K,className:"col-span-12 md:col-span-4"}),e.jsx(x,{...l.getInputProps("owner"),label:"Kepemilikan",placeholder:"Pilih Kepemilikan",data:C,className:"col-span-12 md:col-span-4"}),e.jsx(E,{label:"Provinsi",placeholder:"Pilih Provinsi",className:"col-span-12 md:col-span-4",nothingFoundMessage:"Data tidak ditemukan",value:(h=s.province)==null?void 0:h.toString(),onChange:i=>{t({province:i,district:null,regency:null})}}),e.jsx(D,{provinceId:s.province,label:"Kabupaten/Kota",placeholder:"Pilih Kabupaten/Kota",className:"col-span-12 md:col-span-4",nothingFoundMessage:s.province?"Data tidak ditemukan":"Pilih provinsi terlebih dahulu",value:(p=s.regency)==null?void 0:p.toString(),onChange:i=>{t({...s,regency:i,district:null})}}),e.jsx(M,{regencyId:s.regency,label:"Kecamatan",placeholder:"Pilih Kecamatan",className:"col-span-12 md:col-span-4",nothingFoundMessage:s.province&&s.regency?"Data tidak ditemukan":"Pilih kabupaten terlebih dahulu",value:(r=s.district)==null?void 0:r.toString(),onChange:i=>{t({...s,district:i})}})]}),e.jsxs("div",{className:"pt-4 grid grid-cols-12 gap-x-6 gap-y-4",children:[e.jsx(c,{...l.getInputProps("address"),label:"Alamat",placeholder:"Ex : Jl. Sultan Adam No. 24",className:"col-span-12 md:col-span-8"}),e.jsx(R,{...l.getInputProps("phone_number"),hideControls:!0,label:"Telepon",placeholder:"Ex : 085752140605. . .",className:"col-span-12 md:col-span-4"}),e.jsx(c,{...l.getInputProps("email"),label:"Email",placeholder:"Masukan Email",className:"col-span-12 md:col-span-6"}),e.jsx(T,{...l.getInputProps("password"),label:"Password",placeholder:"Masukan Password",className:"col-span-12 md:col-span-6"})]})]}),e.jsxs(d.Section,{p:"lg",withBorder:!0,className:"flex items-center space-x-4",children:[e.jsx(b,{type:"submit",children:"Simpan"}),e.jsx(b,{component:I,to:"/agency",variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"})]})]})},oe=({agency:a})=>{var p,r,i,o,f;const n=k(),{mutateAsync:l}=se(),s=_({initialValues:{name:a.name,address:a.address,classes:a.classes,email:((p=a.user)==null?void 0:p.email)||"",hospital_code:a.hospital_code,latitude:a.latitude,longitude:a.latitude,owner:a.owner,password:"",phone_number:a.phone_number,sector:a.sector}}),[t,m]=S.useState({province:((r=a.kecamatan.kabupaten)==null?void 0:r.province_id.toString())||null,regency:a.kecamatan.kabupaten_id.toString(),district:a.kecamatan.id.toString()}),h=s.onSubmit(async u=>{await l({id:a.id,data:{...u,kecamatan_id:t.district||void 0}},{onSuccess:()=>{g.show({color:"green",message:"Instansi berhasil diubah"}),n("/agency")},onError:({response:y})=>{s.setErrors((y==null?void 0:y.data).errors),g.show({color:"red",message:"Instansi gagal diubah"})}})});return e.jsxs(d,{component:"form",onSubmit:h,shadow:"lg",children:[e.jsx(d.Section,{p:"lg",withBorder:!0,children:e.jsx("h2",{className:"font-semibold text-base",children:"Edit Data Instansi"})}),e.jsxs(d.Section,{p:"lg",pt:"xs",withBorder:!0,children:[e.jsxs("div",{className:"pb-6 grid grid-cols-12 gap-x-6 gap-y-4 border-b border-gray-300",children:[e.jsx(c,{...s.getInputProps("hospital_code"),label:"Kode RS",placeholder:"Ex : 20392",className:"col-span-12 md:col-span-4"}),e.jsx(c,{...s.getInputProps("name"),label:"Nama Instansi",placeholder:"Ex : RS Umum Daerah H. Sahudin Kutacane. . .",className:"col-span-12 md:col-span-8"}),e.jsx(x,{...s.getInputProps("sector"),label:"Sektor",placeholder:"Pilih Sektor",data:A,className:"col-span-12 md:col-span-4"}),e.jsx(x,{...s.getInputProps("classes"),label:"Kelas",placeholder:"Pilih Kelas",data:K,className:"col-span-12 md:col-span-4"}),e.jsx(x,{...s.getInputProps("owner"),label:"Kepemilikan",placeholder:"Pilih Kepemilikan",data:C,className:"col-span-12 md:col-span-4"}),e.jsx(E,{label:"Provinsi",placeholder:"Pilih Provinsi",className:"col-span-12 md:col-span-4",nothingFoundMessage:"Data tidak ditemukan",value:(i=t.province)==null?void 0:i.toString(),onChange:u=>{m({province:u,district:null,regency:null})}}),e.jsx(D,{provinceId:t.province,label:"Kabupaten/Kota",placeholder:"Pilih Kabupaten/Kota",className:"col-span-12 md:col-span-4",nothingFoundMessage:t.province?"Data tidak ditemukan":"Pilih provinsi terlebih dahulu",value:(o=t.regency)==null?void 0:o.toString(),onChange:u=>{m({...t,regency:u,district:null})}}),e.jsx(M,{regencyId:t.regency,label:"Kecamatan",placeholder:"Pilih Kecamatan",className:"col-span-12 md:col-span-4",nothingFoundMessage:t.province&&t.regency?"Data tidak ditemukan":"Pilih kabupaten terlebih dahulu",value:(f=t.district)==null?void 0:f.toString(),onChange:u=>{m({...t,district:u})}})]}),e.jsxs("div",{className:"pt-4 grid grid-cols-12 gap-x-6 gap-y-4",children:[e.jsx(c,{...s.getInputProps("address"),label:"Alamat",placeholder:"Ex : Jl. Sultan Adam No. 24",className:"col-span-12 md:col-span-8"}),e.jsx(R,{...s.getInputProps("phone_number"),hideControls:!0,label:"Telepon",placeholder:"Ex : 085752140605. . .",className:"col-span-12 md:col-span-4"}),e.jsx(c,{...s.getInputProps("email"),label:"Email",placeholder:"Masukan Email",className:"col-span-12 md:col-span-6"}),e.jsx(T,{...s.getInputProps("password"),label:"Password",placeholder:"Biarkan kosong jika tidak berubah",className:"col-span-12 md:col-span-6"})]})]}),e.jsxs(d.Section,{p:"lg",withBorder:!0,className:"flex items-center space-x-4",children:[e.jsx(b,{type:"submit",children:"Simpan"}),e.jsx(b,{component:I,to:"/agency",variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"})]})]})},ke=()=>{const[a,n]=S.useState({search:"",limit:10}),[l]=O(a,200);return e.jsxs("main",{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Instansi"}),e.jsx(b,{component:I,to:"/agency/create",children:"Tambah"})]}),e.jsx("section",{className:"space-y-4 mb-4",children:e.jsx("div",{className:"space-x-4 flex items-center",children:e.jsx("div",{className:"max-w-xs w-full",children:e.jsx(c,{leftSection:e.jsx(J,{size:16}),placeholder:"Cari berdasarkan nama atau alamat",value:a.search,onChange:s=>n({...a,search:s.target.value})})})})}),e.jsx("section",{className:"mb-8",children:e.jsx(re,{...l})})]})},fe=()=>e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Instansi"})}),e.jsx(ie,{})]}),we=()=>{const{id:a}=Q(),{data:n,isLoading:l,isError:s}=ee({id:a}),t=k();return l?e.jsx("div",{className:"mt-48",children:e.jsx(V,{})}):s?e.jsxs("div",{className:"mt-48 text-center",children:[e.jsx("h1",{className:"text-lg font-bold mb-2",children:"Instansi tidak ditemukan"}),e.jsx(b,{onClick:()=>t(-1),leftSection:e.jsx(W,{size:14}),children:"Kembali"})]}):e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Instansi"})}),e.jsx(oe,{agency:n})]})};export{ke as Agencies,fe as AgencyCreate,ie as AgencyCreateForm,Ce as AgencySelect,re as AgencyTable,we as AgencyUpdate,oe as AgencyUpdateForm,K as CLASSES,C as OWNERSHIP,A as SECTORS};
