import{u as N,q as P,a as x,h as y,r as u,j as e,f as I,L as S,m as w,n as j,I as _,g as f,B as v,i as F}from"./index-cfc5752b.js";import{T as M,I as B,a as R,b as T,S as m}from"./Table-56d81558.js";import{d as q}from"./dayjs-39ed333d.js";import{u as L}from"./AgencySelect-12b0c7e1.js";import{A as Pe}from"./AgencySelect-12b0c7e1.js";import{u as A,C as h,T as d}from"./use-form-84ce6720.js";import{P as K}from"./PasswordInput-bf1949d0.js";import{L as U}from"./LoadingScreen-6743b692.js";import{I as $}from"./IconArrowLeft-16298ded.js";async function H({data:a}){return(await x.post("/ar-service/customer",a)).data}function Q({config:a}={}){return N(H,{...a,onSuccess:(...t)=>{P.invalidateQueries(["agencies"]),a!=null&&a.onSuccess&&a.onSuccess(...t)}})}async function V({id:a}){return(await x.get(`/ar-service/customer/${a}`)).data.data}function Y({config:a,id:t}){return y({...a,queryKey:["agency",t],queryFn:()=>V({id:t})})}async function z({id:a,data:t}){return(await x.put(`/ar-service/customer/${a}`,t)).data}function J({config:a}={}){return N(z,{...a,onSuccess:(...t)=>{P.invalidateQueries(["agencies"]),P.invalidateQueries(["agency",t[1].id]),a!=null&&a.onSuccess&&a.onSuccess(...t)}})}async function O({id:a}){return(await x.delete(`/ar-service/customer/${a}`)).data}function X({config:a}={}){return N(O,{...a,onSuccess:(...t)=>{P.invalidateQueries(["agencies"]),a!=null&&a.onSuccess&&a.onSuccess(...t)}})}const G={page:1,limit:10,search:""},W=({toolbar:a})=>{const[t,r]=u.useState(G),{data:s,isLoading:n}=L({params:t}),o=X();function c(i){return()=>{w.openConfirmModal({title:"Hapus Instansi",children:e.jsx("div",{className:"text-sm",children:"Apakah anda yakin untuk menghapus instansi ini?"}),centered:!0,closeOnConfirm:!1,onConfirm:async()=>{await o.mutateAsync({id:i},{onSuccess:()=>{j.show({message:"Instansi berhasil dihapus",color:"green",icon:e.jsx(T,{})}),w.closeAll()},onError:()=>{j.show({message:"Instansi tidak bisa dihapus",color:"red",icon:e.jsx(_,{})}),w.closeAll()}})}})}}return e.jsx(M,{title:"Tabel Data Instansi",toolbar:a,header:["Instansi","Kelas","Alamat","Provinsi/Area","Created At",""],items:s==null?void 0:s.data,onPageChange:i=>{r({...t,page:i})},loading:n,metadata:{count:(s==null?void 0:s.data.length)||10,limit:t.limit||10,page:t.page||10,total:(s==null?void 0:s.total)||10},renderItem:i=>{var p,l;return e.jsxs("tr",{children:[e.jsx("td",{children:i.name}),e.jsx("td",{children:i.classes}),e.jsx("td",{children:i.address}),e.jsx("td",{children:((l=(p=i.kecamatan.kabupaten)==null?void 0:p.province)==null?void 0:l.name)??"-"}),e.jsx("td",{children:q(i.createdAt).format("D MMMM YYYY H:mm")}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{component:S,to:`/agency/${i.id}`,title:"Update Instansi",color:"primary",radius:"lg",children:e.jsx(B,{size:18})}),e.jsx(I,{onClick:c(i.id),title:"Hapus Instansi",color:"red",radius:"lg",children:e.jsx(R,{size:18})})]})})]},i.id)}})};async function Z(){return(await x.get("/ar-service/region/province")).data.data}function ee({config:a}={}){return y({...a,queryKey:["provinces"],queryFn:()=>Z(),keepPreviousData:!0})}async function ae(a){return(await x.get(`/ar-service/region/kecamatan/${a}`)).data.data}function se({regencyId:a,config:t}){return y({...t,queryKey:["districts",a],queryFn:()=>ae(a),keepPreviousData:!0})}async function te(a){return(await x.get(`/ar-service/region/kabupaten/${a}`)).data.data}function ne({provinceId:a,config:t}){return y({...t,queryKey:["regencies",a],queryFn:()=>te(a),keepPreviousData:!0})}const D=({...a})=>{const{data:t}=ee(),r=u.useMemo(()=>t?t.map(({id:s,name:n})=>({label:n,value:s.toString()})):[],[t]);return e.jsx(m,{...a,data:r,searchable:!0})},C=({provinceId:a,...t})=>{const[r,s]=u.useState(""),{data:n}=ne({provinceId:a||0,config:{enabled:!!a}}),o=u.useMemo(()=>!n||!a?[]:n.map(({id:c,name:i})=>({label:i,value:c.toString()})),[n,a]);return u.useEffect(()=>{s("")},[a]),e.jsx(m,{...t,data:o,searchable:!0,searchValue:r,onSearchChange:s})},E=({regencyId:a,...t})=>{const[r,s]=u.useState(""),{data:n}=se({regencyId:a||0,config:{enabled:!!a}}),o=u.useMemo(()=>!n||!a?[]:n.map(({id:c,name:i})=>({label:i,value:c.toString()})),[n,a]);return u.useEffect(()=>{s("")},[a]),e.jsx(m,{...t,data:o,searchable:!0,searchValue:r,onSearchChange:s})},re=()=>{var c,i,p;const a=f(),{mutateAsync:t}=Q(),r=A({initialValues:{name:"",address:"",email:"",classes:void 0,hospital_code:void 0,kecamatan_id:void 0,latitude:0,longitude:0,owner:"",password:"",phone_number:"",sector:void 0}}),[s,n]=u.useState({province:null,district:null,regency:null}),o=r.onSubmit(async l=>{await t({data:{...l,kecamatan_id:s.district||void 0}},{onSuccess:()=>{j.show({color:"green",message:"Instansi berhasil dibuat"}),a("/agency")},onError:({response:b})=>{r.setErrors((b==null?void 0:b.data).errors),j.show({color:"red",message:"Instansi gagal dibuat"})}})});return e.jsxs(h,{component:"form",onSubmit:o,shadow:"lg",children:[e.jsx(h.Section,{p:"lg",withBorder:!0,children:e.jsx("h2",{className:"font-semibold text-base",children:"Tambah Data Instansi"})}),e.jsxs(h.Section,{p:"lg",pt:"xs",children:[e.jsxs("div",{className:"pb-6 grid grid-cols-12 gap-x-6 gap-y-4 border-b border-gray-300",children:[e.jsx(d,{...r.getInputProps("hospital_code"),label:"Kode RS",placeholder:"Ex : 20392",className:"col-span-12 md:col-span-4"}),e.jsx(d,{...r.getInputProps("name"),label:"Nama Instansi",placeholder:"Ex : RS Umum Daerah H. Sahudin Kutacane. . .",className:"col-span-12 md:col-span-8"}),e.jsx(m,{...r.getInputProps("sector"),label:"Sektor",placeholder:"Pilih Sektor",data:["Private","Public"],className:"col-span-12 md:col-span-4",withinPortal:!0}),e.jsx(m,{...r.getInputProps("classes"),label:"Kelas",placeholder:"Pilih Kelas",data:["A","B","C","D","D Pratama"],className:"col-span-12 md:col-span-4",withinPortal:!0}),e.jsx(m,{...r.getInputProps("owner"),label:"Kepemilikan",placeholder:"Pilih Kepemilikan",data:["Perorangan","Korporasi","Negara"],className:"col-span-12 md:col-span-4",withinPortal:!0}),e.jsx(D,{label:"Provinsi",placeholder:"Pilih Provinsi",className:"col-span-12 md:col-span-4",withinPortal:!0,nothingFound:"Data tidak ditemukan",value:(c=s.province)==null?void 0:c.toString(),onChange:l=>{n({province:l,district:null,regency:null})}}),e.jsx(C,{provinceId:s.province,label:"Kabupaten/Kota",placeholder:"Pilih Kabupaten/Kota",className:"col-span-12 md:col-span-4",withinPortal:!0,nothingFound:s.province?"Data tidak ditemukan":"Pilih provinsi terlebih dahulu",value:(i=s.regency)==null?void 0:i.toString(),onChange:l=>{n({...s,regency:l,district:null})}}),e.jsx(E,{regencyId:s.regency,label:"Kecamatan",placeholder:"Pilih Kecamatan",className:"col-span-12 md:col-span-4",withinPortal:!0,nothingFound:s.province&&s.regency?"Data tidak ditemukan":"Pilih kabupaten terlebih dahulu",value:(p=s.district)==null?void 0:p.toString(),onChange:l=>{n({...s,district:l})}})]}),e.jsxs("div",{className:"pt-4 grid grid-cols-12 gap-x-6 gap-y-4",children:[e.jsx(d,{...r.getInputProps("address"),label:"Alamat",placeholder:"Ex : Jl. Sultan Adam No. 24",className:"col-span-12 md:col-span-8"}),e.jsx(d,{...r.getInputProps("phone_number"),label:"Telepon",placeholder:"Ex : 085752140605. . .",className:"col-span-12 md:col-span-4"}),e.jsx(d,{...r.getInputProps("email"),label:"Email",placeholder:"Masukan Email",className:"col-span-12 md:col-span-6"}),e.jsx(K,{...r.getInputProps("password"),label:"Password",placeholder:"Masukan Password",className:"col-span-12 md:col-span-6"})]})]}),e.jsxs(h.Section,{p:"lg",withBorder:!0,className:"flex justify-end items-center space-x-4",children:[e.jsx(v,{component:S,to:"/agency",variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"}),e.jsx(v,{type:"submit",children:"Simpan"})]})]})},ie=({agency:a})=>{var i,p,l,b;const t=f(),{mutateAsync:r}=J(),s=A({initialValues:{name:a.name,address:a.address,classes:a.classes,email:a.email,hospital_code:a.hospital_code,latitude:a.latitude,longitude:a.latitude,owner:a.owner,password:"",phone_number:a.phone_number,sector:a.sector}}),[n,o]=u.useState({province:((i=a.kecamatan.kabupaten)==null?void 0:i.province_id)||null,regency:a.kecamatan.kabupaten_id,district:a.kecamatan.id}),c=s.onSubmit(async g=>{await r({id:a.id,data:{...g,kecamatan_id:n.district||void 0}},{onSuccess:()=>{j.show({color:"green",message:"Instansi berhasil diubah"}),t("/agency")},onError:({response:k})=>{s.setErrors((k==null?void 0:k.data).errors),j.show({color:"red",message:"Instansi gagal diubah"})}})});return e.jsxs(h,{component:"form",onSubmit:c,shadow:"lg",children:[e.jsx(h.Section,{p:"lg",withBorder:!0,children:e.jsx("h2",{className:"font-semibold text-base",children:"Edit Data Instansi"})}),e.jsxs(h.Section,{p:"lg",pt:"xs",children:[e.jsxs("div",{className:"pb-6 grid grid-cols-12 gap-x-6 gap-y-4 border-b border-gray-300",children:[e.jsx(d,{...s.getInputProps("hospital_code"),label:"Kode RS",placeholder:"Ex : 20392",className:"col-span-12 md:col-span-4"}),e.jsx(d,{...s.getInputProps("name"),label:"Nama Instansi",placeholder:"Ex : RS Umum Daerah H. Sahudin Kutacane. . .",className:"col-span-12 md:col-span-8"}),e.jsx(m,{...s.getInputProps("sector"),label:"Sektor",placeholder:"Pilih Sektor",data:["Private","Public"],className:"col-span-12 md:col-span-4",withinPortal:!0}),e.jsx(m,{...s.getInputProps("classes"),label:"Kelas",placeholder:"Pilih Kelas",data:["A","B","C","D","D Pratama"],className:"col-span-12 md:col-span-4",withinPortal:!0}),e.jsx(m,{...s.getInputProps("owner"),label:"Kepemilikan",placeholder:"Pilih Kepemilikan",data:["Perorangan","Korporasi","Negara"],className:"col-span-12 md:col-span-4",withinPortal:!0}),e.jsx(D,{label:"Provinsi",placeholder:"Pilih Provinsi",className:"col-span-12 md:col-span-4",withinPortal:!0,nothingFound:"Data tidak ditemukan",value:(p=n.province)==null?void 0:p.toString(),onChange:g=>{o({province:g,district:null,regency:null})}}),e.jsx(C,{provinceId:n.province,label:"Kabupaten/Kota",placeholder:"Pilih Kabupaten/Kota",className:"col-span-12 md:col-span-4",withinPortal:!0,nothingFound:n.province?"Data tidak ditemukan":"Pilih provinsi terlebih dahulu",value:(l=n.regency)==null?void 0:l.toString(),onChange:g=>{o({...n,regency:g,district:null})}}),e.jsx(E,{regencyId:n.regency,label:"Kecamatan",placeholder:"Pilih Kecamatan",className:"col-span-12 md:col-span-4",withinPortal:!0,nothingFound:n.province&&n.regency?"Data tidak ditemukan":"Pilih kabupaten terlebih dahulu",value:(b=n.district)==null?void 0:b.toString(),onChange:g=>{o({...n,district:g})}})]}),e.jsxs("div",{className:"pt-4 grid grid-cols-12 gap-x-6 gap-y-4",children:[e.jsx(d,{...s.getInputProps("address"),label:"Alamat",placeholder:"Ex : Jl. Sultan Adam No. 24",className:"col-span-12 md:col-span-8"}),e.jsx(d,{...s.getInputProps("phone_number"),label:"Telepon",placeholder:"Ex : 085752140605. . .",className:"col-span-12 md:col-span-4"}),e.jsx(d,{...s.getInputProps("email"),label:"Email",placeholder:"Masukan Email",className:"col-span-12 md:col-span-6"}),e.jsx(K,{...s.getInputProps("password"),label:"Password",placeholder:"Biarkan kosong jika tidak berubah",className:"col-span-12 md:col-span-6"})]})]}),e.jsxs(h.Section,{p:"lg",withBorder:!0,className:"flex justify-end items-center space-x-4",children:[e.jsx(v,{component:S,to:"/agency",variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"}),e.jsx(v,{type:"submit",children:"Simpan"})]})]})},ge=()=>e.jsxs("main",{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Instansi"}),e.jsx(v,{component:S,to:"/agency/create",children:"Tambah"})]}),e.jsx("section",{className:"mb-8",children:e.jsx(W,{})})]}),xe=()=>e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Instansi"})}),e.jsx(re,{})]}),be=()=>{const{id:a}=F(),{data:t,isLoading:r,isError:s}=Y({id:a}),n=f();return r?e.jsx("div",{className:"mt-48",children:e.jsx(U,{})}):s?e.jsxs("div",{className:"mt-48 text-center",children:[e.jsx("h1",{className:"text-lg font-bold mb-2",children:"Instansi tidak ditemukan"}),e.jsx(v,{onClick:()=>n(-1),leftIcon:e.jsx($,{size:14}),children:"Kembali"})]}):e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Instansi"})}),e.jsx(ie,{agency:t})]})};export{ge as Agencies,xe as AgencyCreate,re as AgencyCreateForm,Pe as AgencySelect,W as AgencyTable,be as AgencyUpdate,ie as AgencyUpdateForm};
