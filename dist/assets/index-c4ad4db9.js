import{u as P,q as j,a as v,e as T,r as S,j as e,i as B,f as w,L as I,t as N,n as g,I as F,p as k,B as b,v as L}from"./index-e06ce023.js";import{T as H}from"./Table-97197763.js";import{u as Q}from"./AgencySelect-7a6d9b49.js";import{A as we}from"./AgencySelect-7a6d9b49.js";import{I as U}from"./IconEdit-6881a034.js";import{I as q,a as z,u as Y,L as $}from"./LoadingScreen-516c392c.js";import{T as c}from"./TextInput-1d09d26d.js";import{I as O}from"./IconSearch-a3e3d9c4.js";import{S as f,C as A,O as K,P as C,R as E,D}from"./index-cfef8163.js";import{u as M}from"./use-form-d1364dbb.js";import{C as d,S as x}from"./Select-fb1ec025.js";import{N as _}from"./NumberInput-8d7650ce.js";import{P as R}from"./PasswordInput-c82fc006.js";import{I as V}from"./IconArrowLeft-76b59d16.js";import"./ScrollArea-c90c52a0.js";async function J({data:a}){return(await v.post("/ar-service/customer",a)).data}function W({config:a}={}){return P(J,{...a,onSuccess:(...n)=>{j.invalidateQueries(["agencies"]),a!=null&&a.onSuccess&&a.onSuccess(...n)}})}async function X({id:a}){return(await v.get(`/ar-service/customer/${a}`)).data.data}function G({config:a,id:n}){return T({...a,queryKey:["agency",n],queryFn:()=>X({id:n})})}async function Z({id:a,data:n}){return(await v.put(`/ar-service/customer/${a}`,n)).data}function ee({config:a}={}){return P(Z,{...a,onSuccess:(...n)=>{j.invalidateQueries(["agencies"]),j.invalidateQueries(["agency",n[1].id]),a!=null&&a.onSuccess&&a.onSuccess(...n)}})}async function ae({id:a}){return(await v.delete(`/ar-service/customer/${a}`)).data}function se({config:a}={}){return P(ae,{...a,onSuccess:(...n)=>{j.invalidateQueries(["agencies"]),a!=null&&a.onSuccess&&a.onSuccess(...n)}})}const te={page:1,limit:10,search:""},ne=({toolbar:a,...n})=>{const[l,s]=S.useState(te),{data:t,isLoading:m}=Q({params:{...l,...n}}),h=se();function p(r){return()=>{N.openConfirmModal({title:"Hapus Instansi",children:e.jsx("div",{className:"text-sm",children:"Apakah anda yakin untuk menghapus instansi ini?"}),centered:!0,onConfirm:async()=>{await h.mutateAsync({id:r},{onSuccess:()=>{g.show({message:"Instansi berhasil dihapus",color:"green",icon:e.jsx(z,{})}),N.closeAll()},onError:()=>{g.show({message:"Instansi tidak bisa dihapus",color:"red",icon:e.jsx(F,{})}),N.closeAll()}})}})}}return e.jsx(H,{title:"Tabel Data Instansi",toolbar:a,header:["Instansi","Kelas","Alamat","Provinsi/Area","Created At",""],items:t==null?void 0:t.data,onPageChange:r=>{s({...l,page:r})},loading:m,metadata:{count:(t==null?void 0:t.data.length)||10,limit:l.limit||10,page:l.page||10,total:(t==null?void 0:t.total)||10},renderItem:r=>{var i,o;return e.jsxs("tr",{children:[e.jsx("td",{children:r.name}),e.jsx("td",{children:r.classes}),e.jsx("td",{children:r.address}),e.jsx("td",{children:((o=(i=r.kecamatan.kabupaten)==null?void 0:i.province)==null?void 0:o.name)??"-"}),e.jsx("td",{children:B(r.created_at).format("D MMMM YYYY H:mm")}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{variant:"subtle",component:I,to:`/agency/${r.id}`,title:"Update Instansi",color:"primary",radius:"lg",children:e.jsx(U,{size:18})}),e.jsx(w,{variant:"subtle",onClick:p(r.id),title:"Hapus Instansi",color:"red",radius:"lg",children:e.jsx(q,{size:18})})]})})]},r.id)}})},le=()=>{var h,p,r;const a=k(),{mutateAsync:n}=W(),l=M({initialValues:{name:"",address:"",email:"",classes:void 0,hospital_code:void 0,kecamatan_id:void 0,latitude:0,longitude:0,owner:"",password:"",phone_number:"",sector:void 0}}),[s,t]=S.useState({province:null,district:null,regency:null}),m=l.onSubmit(async i=>{await n({data:{...i,kecamatan_id:s.district||void 0}},{onSuccess:()=>{g.show({color:"green",message:"Instansi berhasil dibuat"}),a("/agency")},onError:({response:o})=>{l.setErrors((o==null?void 0:o.data).errors),g.show({color:"red",message:"Instansi gagal dibuat"})}})});return e.jsxs(d,{component:"form",onSubmit:m,shadow:"lg",children:[e.jsx(d.Section,{p:"lg",withBorder:!0,children:e.jsx("h2",{className:"font-semibold text-base",children:"Tambah Data Instansi"})}),e.jsxs(d.Section,{p:"lg",pt:"xs",withBorder:!0,children:[e.jsxs("div",{className:"pb-6 grid grid-cols-12 gap-x-6 gap-y-4 border-b border-gray-300",children:[e.jsx(c,{...l.getInputProps("hospital_code"),label:"Kode RS",placeholder:"Ex : 20392",className:"col-span-12 md:col-span-4"}),e.jsx(c,{...l.getInputProps("name"),label:"Nama Instansi",placeholder:"Ex : RS Umum Daerah H. Sahudin Kutacane. . .",className:"col-span-12 md:col-span-8"}),e.jsx(x,{...l.getInputProps("sector"),label:"Sektor",placeholder:"Pilih Sektor",data:f,className:"col-span-12 md:col-span-4"}),e.jsx(x,{...l.getInputProps("classes"),label:"Kelas",placeholder:"Pilih Kelas",data:A,className:"col-span-12 md:col-span-4"}),e.jsx(x,{...l.getInputProps("owner"),label:"Kepemilikan",placeholder:"Pilih Kepemilikan",data:K,className:"col-span-12 md:col-span-4"}),e.jsx(C,{label:"Provinsi",placeholder:"Pilih Provinsi",className:"col-span-12 md:col-span-4",nothingFoundMessage:"Data tidak ditemukan",value:(h=s.province)==null?void 0:h.toString(),onChange:i=>{t({province:i,district:null,regency:null})}}),e.jsx(E,{provinceId:s.province,label:"Kabupaten/Kota",placeholder:"Pilih Kabupaten/Kota",className:"col-span-12 md:col-span-4",nothingFoundMessage:s.province?"Data tidak ditemukan":"Pilih provinsi terlebih dahulu",value:(p=s.regency)==null?void 0:p.toString(),onChange:i=>{t({...s,regency:i,district:null})}}),e.jsx(D,{regencyId:s.regency,label:"Kecamatan",placeholder:"Pilih Kecamatan",className:"col-span-12 md:col-span-4",nothingFoundMessage:s.province&&s.regency?"Data tidak ditemukan":"Pilih kabupaten terlebih dahulu",value:(r=s.district)==null?void 0:r.toString(),onChange:i=>{t({...s,district:i})}})]}),e.jsxs("div",{className:"pt-4 grid grid-cols-12 gap-x-6 gap-y-4",children:[e.jsx(c,{...l.getInputProps("address"),label:"Alamat",placeholder:"Ex : Jl. Sultan Adam No. 24",className:"col-span-12 md:col-span-8"}),e.jsx(_,{...l.getInputProps("phone_number"),hideControls:!0,label:"Telepon",placeholder:"Ex : 085752140605. . .",className:"col-span-12 md:col-span-4"}),e.jsx(c,{...l.getInputProps("email"),label:"Email",placeholder:"Masukan Email",className:"col-span-12 md:col-span-6"}),e.jsx(R,{...l.getInputProps("password"),label:"Password",placeholder:"Masukan Password",className:"col-span-12 md:col-span-6"})]})]}),e.jsxs(d.Section,{p:"lg",withBorder:!0,className:"flex items-center space-x-4",children:[e.jsx(b,{type:"submit",children:"Simpan"}),e.jsx(b,{component:I,to:"/agency",variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"})]})]})},re=({agency:a})=>{var p,r,i,o;const n=k(),{mutateAsync:l}=ee(),s=M({initialValues:{name:a.name,address:a.address,classes:a.classes,email:a.email,hospital_code:a.hospital_code,latitude:a.latitude,longitude:a.latitude,owner:a.owner,password:"",phone_number:a.phone_number,sector:a.sector}}),[t,m]=S.useState({province:((p=a.kecamatan.kabupaten)==null?void 0:p.province_id.toString())||null,regency:a.kecamatan.kabupaten_id.toString(),district:a.kecamatan.id.toString()}),h=s.onSubmit(async u=>{await l({id:a.id,data:{...u,kecamatan_id:t.district||void 0}},{onSuccess:()=>{g.show({color:"green",message:"Instansi berhasil diubah"}),n("/agency")},onError:({response:y})=>{s.setErrors((y==null?void 0:y.data).errors),g.show({color:"red",message:"Instansi gagal diubah"})}})});return e.jsxs(d,{component:"form",onSubmit:h,shadow:"lg",children:[e.jsx(d.Section,{p:"lg",withBorder:!0,children:e.jsx("h2",{className:"font-semibold text-base",children:"Edit Data Instansi"})}),e.jsxs(d.Section,{p:"lg",pt:"xs",withBorder:!0,children:[e.jsxs("div",{className:"pb-6 grid grid-cols-12 gap-x-6 gap-y-4 border-b border-gray-300",children:[e.jsx(c,{...s.getInputProps("hospital_code"),label:"Kode RS",placeholder:"Ex : 20392",className:"col-span-12 md:col-span-4"}),e.jsx(c,{...s.getInputProps("name"),label:"Nama Instansi",placeholder:"Ex : RS Umum Daerah H. Sahudin Kutacane. . .",className:"col-span-12 md:col-span-8"}),e.jsx(x,{...s.getInputProps("sector"),label:"Sektor",placeholder:"Pilih Sektor",data:f,className:"col-span-12 md:col-span-4"}),e.jsx(x,{...s.getInputProps("classes"),label:"Kelas",placeholder:"Pilih Kelas",data:A,className:"col-span-12 md:col-span-4"}),e.jsx(x,{...s.getInputProps("owner"),label:"Kepemilikan",placeholder:"Pilih Kepemilikan",data:K,className:"col-span-12 md:col-span-4"}),e.jsx(C,{label:"Provinsi",placeholder:"Pilih Provinsi",className:"col-span-12 md:col-span-4",nothingFoundMessage:"Data tidak ditemukan",value:(r=t.province)==null?void 0:r.toString(),onChange:u=>{m({province:u,district:null,regency:null})}}),e.jsx(E,{provinceId:t.province,label:"Kabupaten/Kota",placeholder:"Pilih Kabupaten/Kota",className:"col-span-12 md:col-span-4",nothingFoundMessage:t.province?"Data tidak ditemukan":"Pilih provinsi terlebih dahulu",value:(i=t.regency)==null?void 0:i.toString(),onChange:u=>{m({...t,regency:u,district:null})}}),e.jsx(D,{regencyId:t.regency,label:"Kecamatan",placeholder:"Pilih Kecamatan",className:"col-span-12 md:col-span-4",nothingFoundMessage:t.province&&t.regency?"Data tidak ditemukan":"Pilih kabupaten terlebih dahulu",value:(o=t.district)==null?void 0:o.toString(),onChange:u=>{m({...t,district:u})}})]}),e.jsxs("div",{className:"pt-4 grid grid-cols-12 gap-x-6 gap-y-4",children:[e.jsx(c,{...s.getInputProps("address"),label:"Alamat",placeholder:"Ex : Jl. Sultan Adam No. 24",className:"col-span-12 md:col-span-8"}),e.jsx(_,{...s.getInputProps("phone_number"),hideControls:!0,label:"Telepon",placeholder:"Ex : 085752140605. . .",className:"col-span-12 md:col-span-4"}),e.jsx(c,{...s.getInputProps("email"),label:"Email",placeholder:"Masukan Email",className:"col-span-12 md:col-span-6"}),e.jsx(R,{...s.getInputProps("password"),label:"Password",placeholder:"Biarkan kosong jika tidak berubah",className:"col-span-12 md:col-span-6"})]})]}),e.jsxs(d.Section,{p:"lg",withBorder:!0,className:"flex items-center space-x-4",children:[e.jsx(b,{type:"submit",children:"Simpan"}),e.jsx(b,{component:I,to:"/agency",variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"})]})]})},Ie=()=>{const[a,n]=S.useState({search:"",limit:10}),[l]=Y(a,200);return e.jsxs("main",{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Instansi"}),e.jsx(b,{component:I,to:"/agency/create",children:"Tambah"})]}),e.jsx("section",{className:"space-y-4 mb-4",children:e.jsx("div",{className:"space-x-4 flex items-center",children:e.jsx("div",{className:"max-w-xs w-full",children:e.jsx(c,{leftSection:e.jsx(O,{size:16}),placeholder:"Cari berdasarkan nama atau alamat",value:a.search,onChange:s=>n({...a,search:s.target.value})})})})}),e.jsx("section",{className:"mb-8",children:e.jsx(ne,{...l})})]})},ye=()=>e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Instansi"})}),e.jsx(le,{})]}),Ne=()=>{const{id:a}=L(),{data:n,isLoading:l,isError:s}=G({id:a}),t=k();return l?e.jsx("div",{className:"mt-48",children:e.jsx($,{})}):s?e.jsxs("div",{className:"mt-48 text-center",children:[e.jsx("h1",{className:"text-lg font-bold mb-2",children:"Instansi tidak ditemukan"}),e.jsx(b,{onClick:()=>t(-1),leftSection:e.jsx(V,{size:14}),children:"Kembali"})]}):e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Instansi"})}),e.jsx(re,{agency:n})]})};export{Ie as Agencies,ye as AgencyCreate,le as AgencyCreateForm,we as AgencySelect,ne as AgencyTable,Ne as AgencyUpdate,re as AgencyUpdateForm,A as CLASSES,K as OWNERSHIP,f as SECTORS};
