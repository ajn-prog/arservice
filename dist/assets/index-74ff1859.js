import{e as P,a as h,u as w,q as j,r as k,j as e,L as m,b as g,B as c,t as y,n as p,p as f,_ as z,v as C,i as L}from"./index-b68a47ac.js";import{P as S}from"./ProductSelect-9541e017.js";import{I as A}from"./IconEdit-21a9d81e.js";import{I as B,u as T,L as F}from"./LoadingScreen-abfdcc41.js";import{I as $}from"./IconPlus-e06e0bbe.js";import{P as V}from"./Pagination-6fe5f734.js";import{T as I}from"./TextEditor-1aa5d2a3.js";import{T as x}from"./TextInput-9c47cdc1.js";import{I as Y}from"./IconSearch-033dc77c.js";import{I as q}from"./IconCategory-69fd5795.js";import{F as D}from"./FileDropzone-03552866.js";import{u as E}from"./use-form-6bcb7ca8.js";import{C as d}from"./Select-8153356c.js";import{I as N}from"./IconArrowLeft-4c504f3c.js";import"./get-base-value-a3788185.js";import"./LoadingOverlay-a7cbfad3.js";import"./IconPhoto-2e7be054.js";import"./ScrollArea-e260c59d.js";const u={png:"image/png",gif:"image/gif",jpeg:"image/jpeg",svg:"image/svg+xml",webp:"image/webp",avif:"image/avif",mp4:"video/mp4",zip:"application/zip",csv:"text/csv",pdf:"application/pdf",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",exe:"application/vnd.microsoft.portable-executable"},_=[u.png,u.gif,u.jpeg,u.svg,u.webp,u.avif];async function K({params:a}){return(await h.get("/ar-service/guide-product",{params:a})).data.data}function O({config:a,params:s}={}){return P({...a,queryKey:["guides",s],queryFn:()=>K({params:s}),keepPreviousData:!0})}async function J({data:a}){const s=new FormData;for(const[t,i]of Object.entries(a))i&&(Array.isArray(i)?i.forEach((n,o)=>{s.append(`${t}[${o}]`,n.toString())}):i instanceof Date?s.append(t,i.toJSON()):i instanceof File?s.append(t,i,i.name):s.append(t,i.toString()));return(await h.post("/ar-service/guide-product",s)).data}function Q({config:a}={}){return w(J,{...a,onSuccess:(...s)=>{j.invalidateQueries(["guides"]),a!=null&&a.onSuccess&&a.onSuccess(...s)}})}async function H({id:a}){return(await h.get(`/ar-service/guide-product/${a}`)).data.data}function M({config:a,id:s}){return P({...a,queryKey:["guide",s],queryFn:()=>H({id:s})})}async function U({id:a}){return(await h.delete(`/ar-service/guide-product/${a}`)).data}function W({config:a}={}){return w(U,{...a,onSuccess:(...s)=>{j.invalidateQueries(["guides"]),a!=null&&a.onSuccess&&a.onSuccess(...s)}})}async function R({id:a,data:s}){const r=new FormData;for(const[i,n]of Object.entries(s))n&&(Array.isArray(n)?n.forEach((o,v)=>{r.append(`${i}[${v}]`,o.toString())}):n instanceof Date?r.append(i,n.toJSON()):n instanceof File?r.append(i,n,n.name):r.append(i,n.toString()));return(await h.post(`/ar-service/guide-product/${a}`,r)).data}function X({config:a}={}){return w(R,{...a,onSuccess:(...s)=>{j.invalidateQueries(["guides"]),j.invalidateQueries(["guide"]),a!=null&&a.onSuccess&&a.onSuccess(...s)}})}const Z=a=>{const[s,r]=k.useState({page:1,limit:8,search:"",sort:"desc",sort_by:"created_at"}),{data:t,isLoading:i,isError:n}=O({params:{...s,...a}}),o=W();function v(l,b){return(new DOMParser().parseFromString(l,"text/html").body.textContent||"").split(/\s+/).slice(0,b).join(" ")}function G(l){return()=>{y.openConfirmModal({modalId:"guide-delete",title:"Hapus Panduan",children:e.jsx("div",{className:"text-sm",children:"Apakah Anda yakin untuk menghapus panduan ini?"}),centered:!0,onConfirm:async()=>{await o.mutateAsync({id:l.id},{onSuccess:()=>{p.show({color:"green",message:"Panduan berhasil dihapus"}),y.close("guide-delete")},onError:()=>{p.show({color:"red",message:"Panduan gagal dihapus"}),y.close("guide-delete")}})}})}}return i||n?e.jsx("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:Array(4).fill(0).map((l,b)=>e.jsxs("div",{className:"w-full bg-white rounded-lg overflow-hidden",children:[e.jsx("div",{className:"w-full aspect-video bg-gray-200 animate-pulse"}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-5 w-20 bg-gray-200 animate-pulse rounded-lg mt-1 mb-2"}),e.jsx("div",{className:"bg-gray-200 animate-pulse h-5 w-full rounded-md mb-2"}),e.jsx("div",{className:"bg-gray-200 animate-pulse h-5 w-1/2 rounded-md mb-2"}),e.jsx("div",{className:"h-4 w-12 bg-gray-200 rounded-md animate-pulse"}),e.jsx("div",{className:"space-y-2 mt-2",children:e.jsx("div",{className:"bg-gray-200 w-full h-7 rounded-md"})})]})]},`skp_${b}`))}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:t.data.map(l=>e.jsxs("div",{className:"w-full bg-white rounded-lg overflow-hidden",children:[e.jsx(m,{to:`/guide/${l.id}`,children:e.jsx("div",{className:"w-full aspect-video bg-gray-200 relative",children:e.jsx("img",{src:(l==null?void 0:l.image)||"/default_image.png",alt:"",className:"absolute inset-0 w-full h-full object-cover object-center"})})}),e.jsxs("div",{className:"p-4",children:[e.jsxs(m,{to:`/guide/${l.id}`,children:[e.jsx("h2",{className:"line-clamp-1 text-sm text-primary-600 mb-1",children:l.product.name}),e.jsx("h2",{className:"line-clamp-2 text-base font-bold mb-1 hover:underline",children:l.title}),e.jsx("p",{className:"text-sm line-clamp-2 text-gray-600",children:v(l.description,15)})]}),e.jsx(g,{role:["-Customer"],children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-4",children:[e.jsx(c,{component:m,to:`/guide/${l.id}/update`,variant:"light",leftSection:e.jsx(A,{size:16}),fullWidth:!0,size:"xs",children:"Edit"}),e.jsx(c,{color:"red",variant:"light",leftSection:e.jsx(B,{size:16}),fullWidth:!0,size:"xs",onClick:G(l),children:"Hapus"})]})})]})]},l.id))}),t.data.length==0&&e.jsxs("div",{className:"col-span-12 flex flex-col items-center justify-center py-24 mx-auto max-w-md",children:[e.jsxs("p",{className:"text-lg font-bold mb-4 text-center",children:["Belum ada panduan untuk produk ini",e.jsx(g,{role:["-Customer"],children:", tekan tombol dibawah untuk menambahkan"})]}),e.jsx(g,{role:["-Customer"],children:e.jsx(c,{component:m,to:"/guide/create",leftSection:e.jsx($,{size:16}),children:"Tambah Panduan"})})]}),e.jsx("div",{className:"my-6",children:e.jsx(V,{total:t.last_page,value:t.current_page,onChange:l=>r({...s,page:l}),withEdges:!0})})]})},ee=({product:a})=>{const s=Q(),r=f(),t=E({initialValues:{product_id:a,title:"",image:void 0,description:"",video:""}}),i=t.onSubmit(async n=>{await s.mutateAsync({data:n},{onSuccess:()=>{p.show({color:"green",message:"Panduan berhasil dibuat"}),r("/guide")},onError:({response:o})=>{t.setErrors((o==null?void 0:o.data).errors),p.show({color:"red",message:"Panduan gagal dibuat"})}})});return e.jsxs(d,{component:"form",onSubmit:i,shadow:"lg",children:[e.jsx(d.Section,{p:"lg",withBorder:!0,children:e.jsx("h2",{className:"font-semibold text-base",children:"Tambah Data Panduan"})}),e.jsx(d.Section,{p:"lg",pt:"xs",withBorder:!0,children:e.jsxs("div",{className:"grid grid-cols-12 gap-x-6 gap-y-4 border-b border-gray-300",children:[e.jsx(S,{...t.getInputProps("product_id"),label:"Produk",placeholder:"Pilih Produk",className:"col-span-12 md:col-span-12",limit:20,nothingFoundMessage:"Data tidak ditemukan"}),e.jsx(x,{...t.getInputProps("title"),label:"Judul",placeholder:"Masukan Judul",className:"col-span-12"}),e.jsx(x,{...t.getInputProps("video"),label:"Link Video Youtube (Opsional)",placeholder:"https://",className:"col-span-12"}),e.jsx("div",{className:"col-span-12",children:e.jsx(D,{label:"Foto Sampul",value:t.values.image,onDrop:n=>{t.setFieldValue("image",n[0])},accept:_,maxSize:5*1024**2,maxFiles:1,multiple:!1})}),e.jsx("div",{className:"col-span-12",children:e.jsx(I,{value:t.values.description,onChange:n=>t.setFieldValue("description",n)})})]})}),e.jsxs(d.Section,{p:"lg",withBorder:!0,className:"flex justify-start items-center space-x-4",children:[e.jsx(c,{type:"submit",loading:s.isLoading,children:"Simpan"}),e.jsx(c,{onClick:()=>r(-1),variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"})]})]})},ae=({guide:a})=>{const s=X(),r=f(),t=E({initialValues:{product_id:a.product_id,title:a.title,image:void 0,description:a.description,video:a.video||void 0}}),i=t.onSubmit(async n=>{await s.mutateAsync({id:a.id,data:n},{onSuccess:()=>{p.show({color:"green",message:"Panduan berhasil dirubah"}),r("/guide")},onError:({response:o})=>{t.setErrors((o==null?void 0:o.data).errors),p.show({color:"red",message:"Panduan gagal dirubah"})}})});return e.jsxs(d,{component:"form",onSubmit:i,shadow:"lg",children:[e.jsx(d.Section,{p:"lg",withBorder:!0,children:e.jsx("h2",{className:"font-semibold text-base",children:"Edit Data Panduan"})}),e.jsx(d.Section,{p:"lg",pt:"xs",withBorder:!0,children:e.jsxs("div",{className:"grid grid-cols-12 gap-x-6 gap-y-4 border-b border-gray-300",children:[e.jsx(S,{...t.getInputProps("product_id"),label:"Produk",placeholder:"Pilih Produk",className:"col-span-12 md:col-span-12",limit:20,nothingFoundMessage:"Data tidak ditemukan"}),e.jsx(x,{...t.getInputProps("title"),label:"Judul",placeholder:"Masukan Judul",className:"col-span-12"}),e.jsx(x,{...t.getInputProps("video"),label:"Link Video Youtube (Opsional)",placeholder:"https://",className:"col-span-12"}),e.jsx("div",{className:"col-span-12",children:e.jsx(D,{label:"Foto Sampul",value:t.values.image,onDrop:n=>{t.setFieldValue("image",n[0])},accept:_,maxSize:5*1024**2,maxFiles:1,multiple:!1})}),e.jsx("div",{className:"col-span-12",children:e.jsx(I,{value:t.values.description,onChange:n=>t.setFieldValue("description",n)})})]})}),e.jsxs(d.Section,{p:"lg",withBorder:!0,className:"flex justify-start items-center space-x-4",children:[e.jsx(c,{type:"submit",loading:s.isLoading,children:"Simpan"}),e.jsx(c,{onClick:()=>r(-1),variant:"light",color:"gray.6",bg:"gray.2",children:"Batal"})]})]})},Se=()=>{var t;const[a,s]=k.useState({search:"",product_id:void 0,limit:10}),[r]=T(a,200);return e.jsxs("main",{children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Panduan"}),e.jsx(g,{role:["-Customer"],children:e.jsx(c,{component:m,to:"/guide/create",children:"Tambah"})})]}),e.jsx("section",{className:"space-y-4 mb-4",children:e.jsxs("div",{className:"space-x-4 flex items-center",children:[e.jsx("div",{className:"max-w-xs w-full",children:e.jsx(x,{leftSection:e.jsx(Y,{size:16}),placeholder:"Cari berdasarkan judul",value:a.search,onChange:i=>s({...a,search:i.target.value})})}),e.jsx("div",{className:"max-w-xs",children:e.jsx(S,{leftSection:e.jsx(q,{size:16}),placeholder:"Pilih Produk",value:(t=a.product_id)==null?void 0:t.toString(),onChange:i=>s({...a,product_id:i||void 0}),clearable:!0})})]})}),e.jsxs("section",{className:"mb-8",children:[e.jsx("div",{className:""}),e.jsx(Z,{...r})]})]})},Pe=()=>{const[a]=z();return e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Panduan"})}),e.jsx(ee,{product:a.get("product")||void 0})]})},ke=()=>{const{id:a}=C(),{data:s,isLoading:r,isError:t}=M({id:a}),i=f();return r?e.jsx("div",{className:"mt-48",children:e.jsx(F,{})}):t?e.jsxs("div",{className:"mt-48 text-center",children:[e.jsx("h1",{className:"text-lg font-bold mb-2",children:"Produk tidak ditemukan"}),e.jsx(c,{onClick:()=>i(-1),leftSection:e.jsx(N,{size:14}),children:"Kembali"})]}):e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Panduan"})}),e.jsx(ae,{guide:s})]})},Ce=()=>{const a=f(),{id:s}=C(),{data:r,isLoading:t,isError:i}=M({id:s});return t?e.jsx("div",{className:"mt-48",children:e.jsx(F,{})}):i?e.jsxs("div",{className:"mt-48 text-center",children:[e.jsx("h1",{className:"text-lg font-bold mb-2",children:"Produk tidak ditemukan"}),e.jsx(c,{onClick:()=>a(-1),leftSection:e.jsx(N,{size:14}),children:"Kembali"})]}):e.jsxs("main",{children:[e.jsx("header",{className:"mb-6",children:e.jsx(c,{component:m,to:"/guide",leftSection:e.jsx(N,{size:16}),children:"Kembali"})}),e.jsx(d,{p:"lg",children:e.jsxs("article",{className:"max-w-2xl w-full mx-auto",children:[e.jsxs("header",{children:[e.jsx("h1",{className:"text-xl font-bold",children:r.title}),e.jsx("div",{className:"text-base text-primary-600",children:L(r.created_at).format("D MMMM YYYY")})]}),e.jsx("section",{className:"w-full aspect-video bg-gray-200 rounded-md overflow-hidden relative my-4",children:r.video?e.jsx("iframe",{src:r.video,title:"Kenapa Kita Susah Menabung?",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,className:"w-full h-full inset-0 absolute object-cover object-center"}):e.jsx("img",{src:r.image,alt:"",className:"absolute inset-0 w-full h-full object-cover object-center"})}),e.jsx("section",{className:"prose",dangerouslySetInnerHTML:{__html:r.description}})]})})]})};export{Pe as GuideCreate,Ce as GuideDetail,ke as GuideUpdate,Se as Guides};
