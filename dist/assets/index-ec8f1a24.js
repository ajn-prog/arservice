import{r as p,J as V,l as Q,o as U,F as ve,R as w,p as fe,E as be,D as je,t as J,v as ye,w as we,y as Ne,K as L,c as X,u as ke,q as Pe,a as C,i as Z,M as A,j as e,g as G,m as ee,N as _,f as _e,B as q,O as Ce,L as Se,h as Oe,n as K}from"./index-1a1c1bd9.js";import{Q as Ea,P as Ma}from"./index-1a1c1bd9.js";import{b as ae,u as Ie,T as N}from"./use-form-9b70dbb4.js";import{I as Ee,a as Me,b as qe,c as Ae}from"./IconPlus-d3ee6641.js";import{a as Be,T as $e,C as ze}from"./Table-4a9f9311.js";import{N as De}from"./NumberInput-366c5e09.js";import{L as Te}from"./LoadingScreen-34b7b5f0.js";import"./clamp-73f6bef2.js";function Re(a,s){try{return JSON.stringify(a)}catch{throw new Error(`@mantine/hooks ${s}: Failed to serialize the value`)}}function Fe(a){try{return a&&JSON.parse(a)}catch{return a}}function Ve(a){return{getItem:o=>{try{return window[a].getItem(o)}catch{return console.warn("use-local-storage: Failed to get value from storage, localStorage is blocked"),null}},setItem:(o,i)=>{try{window[a].setItem(o,i)}catch{console.warn("use-local-storage: Failed to set value to storage, localStorage is blocked")}},removeItem:o=>{try{window[a].removeItem(o)}catch{console.warn("use-local-storage: Failed to remove value from storage, localStorage is blocked")}}}}function Je(a,s){const t=a==="localStorage"?"mantine-local-storage":"mantine-session-storage",{getItem:r,setItem:o,removeItem:i}=Ve(a);return function({key:n,defaultValue:l,getInitialValueInEffect:f=!0,deserialize:h=Fe,serialize:u=x=>Re(x,s)}){const x=p.useCallback(d=>{let m;try{m=typeof window>"u"||!(a in window)||window[a]===null||!!d}catch{m=!0}if(m)return l;const y=r(n);return y!==null?h(y):l},[n,l]),[b,g]=p.useState(x(f)),j=p.useCallback(d=>{d instanceof Function?g(m=>{const y=d(m);return o(n,u(y)),window.dispatchEvent(new CustomEvent(t,{detail:{key:n,value:d(m)}})),y}):(o(n,u(d)),window.dispatchEvent(new CustomEvent(t,{detail:{key:n,value:d}})),g(d))},[n]),$=p.useCallback(()=>{i(n),window.dispatchEvent(new CustomEvent(t,{detail:{key:n,value:l}}))},[]);return V("storage",d=>{var m;d.storageArea===window[a]&&d.key===n&&g(h((m=d.newValue)!=null?m:void 0))}),V(t,d=>{d.detail.key===n&&g(d.detail.value)}),p.useEffect(()=>{l!==void 0&&b===void 0&&j(l)},[l,b,j]),p.useEffect(()=>{f&&g(x())},[]),[b===void 0?l:b,j,$]}}function se(a){return Je("localStorage","use-local-storage")(a)}const te=p.createContext(null),Le=te.Provider,Ge=()=>p.useContext(te);var Ke=Object.defineProperty,We=Object.defineProperties,He=Object.getOwnPropertyDescriptors,S=Object.getOwnPropertySymbols,re=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable,W=(a,s,t)=>s in a?Ke(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t,H=(a,s)=>{for(var t in s||(s={}))re.call(s,t)&&W(a,t,s[t]);if(S)for(var t of S(s))ne.call(s,t)&&W(a,t,s[t]);return a},Ye=(a,s)=>We(a,He(s)),Qe=(a,s)=>{var t={};for(var r in a)re.call(a,r)&&s.indexOf(r)<0&&(t[r]=a[r]);if(a!=null&&S)for(var r of S(a))s.indexOf(r)<0&&ne.call(a,r)&&(t[r]=a[r]);return t};const Ue={},B=Q((a,s)=>{const t=U("CheckboxGroup",Ue,a),{value:r,defaultValue:o,onChange:i,size:c,wrapperProps:n,children:l}=t,f=Qe(t,["value","defaultValue","onChange","size","wrapperProps","children"]),[h,u]=ve({value:r,defaultValue:o,finalValue:[],onChange:i}),x=b=>{const g=b.currentTarget.value;u(h.includes(g)?h.filter(j=>j!==g):[...h,g])};return w.createElement(Le,{value:{value:h,onChange:x,size:c}},w.createElement(ae.Wrapper,Ye(H(H({size:c,ref:s},n),f),{labelElement:"div",__staticSelector:"CheckboxGroup"}),w.createElement(Ee,{role:"group"},l)))});B.classes=ae.Wrapper.classes;B.displayName="@mantine/core/CheckboxGroup";var Xe={root:"m-bf2d988c",inner:"m-26062bec",input:"m-26063560",icon:"m-bf295423"};const oe=Xe;var Ze=Object.defineProperty,ea=Object.defineProperties,aa=Object.getOwnPropertyDescriptors,O=Object.getOwnPropertySymbols,ie=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable,Y=(a,s,t)=>s in a?Ze(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t,v=(a,s)=>{for(var t in s||(s={}))ie.call(s,t)&&Y(a,t,s[t]);if(O)for(var t of O(s))le.call(s,t)&&Y(a,t,s[t]);return a},M=(a,s)=>ea(a,aa(s)),sa=(a,s)=>{var t={};for(var r in a)ie.call(a,r)&&s.indexOf(r)<0&&(t[r]=a[r]);if(a!=null&&O)for(var r of O(a))s.indexOf(r)<0&&le.call(a,r)&&(t[r]=a[r]);return t};const ta={labelPosition:"right",icon:Be},ra=ye((a,{radius:s,color:t,size:r,iconColor:o})=>({root:{"--checkbox-size":we(r,"checkbox-size"),"--checkbox-radius":s===void 0?void 0:Ne(s),"--checkbox-color":t?L(t,a):void 0,"--checkbox-icon-color":o?L(o,a):void 0}})),I=Q((a,s)=>{const t=U("Checkbox",ta,a),r=t,{classNames:o,className:i,style:c,styles:n,unstyled:l,vars:f,color:h,label:u,id:x,size:b,radius:g,wrapperProps:j,children:$,checked:d,labelPosition:m,description:y,error:E,disabled:z,variant:de,indeterminate:D,icon:ue,rootRef:me,iconColor:fa}=r,pe=sa(r,["classNames","className","style","styles","unstyled","vars","color","label","id","size","radius","wrapperProps","children","checked","labelPosition","description","error","disabled","variant","indeterminate","icon","rootRef","iconColor"]),k=Ge(),he=b||(k==null?void 0:k.size),xe=ue,P=fe({name:"Checkbox",props:t,classes:oe,className:i,style:c,classNames:o,styles:n,unstyled:l,vars:f,varsResolver:ra}),{styleProps:ge,rest:T}=be(pe),R=je(x),F=k?{checked:k.value.includes(T.value),onChange:k.onChange}:{};return w.createElement(Me,v(v(M(v({},P("root")),{__staticSelector:"Checkbox",__stylesApiProps:t,id:R,size:he,labelPosition:m,label:u,description:y,error:E,disabled:z,classNames:o,styles:n,unstyled:l,"data-checked":F.checked||d||void 0,variant:de,ref:me}),ge),j),w.createElement(J,M(v({},P("inner")),{mod:{"data-label-position":m}}),w.createElement(J,M(v(v(v({component:"input",id:R,ref:s,checked:d,disabled:z,mod:{error:!!E,indeterminate:D}},P("input",{focusable:!0})),T),F),{type:"checkbox"})),w.createElement(xe,v({indeterminate:D},P("icon")))))});I.classes=v(v({},oe),qe);I.displayName="@mantine/core/Checkbox";I.Group=B;var na=X("basket-off","IconBasketOff",[["path",{d:"M17 10l-2 -6",key:"svg-0"}],["path",{d:"M7 10l.75 -2.252m1.001 -3.002l.249 -.746",key:"svg-1"}],["path",{d:"M12 8h7a2 2 0 0 1 1.977 2.304c-.442 2.516 -.756 4.438 -.977 5.696m-1.01 3.003a2.997 2.997 0 0 1 -2.234 .997h-9.512a3 3 0 0 1 -2.965 -2.544l-1.255 -7.152a2 2 0 0 1 1.977 -2.304h2.999",key:"svg-2"}],["path",{d:"M12 12a2 2 0 1 0 2 2",key:"svg-3"}],["path",{d:"M3 3l18 18",key:"svg-4"}]]),oa=X("minus","IconMinus",[["path",{d:"M5 12l14 0",key:"svg-0"}]]);async function ia(a){const{products:s,...t}=a.data,r=new FormData;s.forEach((c,n)=>{r.append(`ids[${n}]`,c.toString())});const o=await C.post("/ar-service/order",r);return(await C.post(`/ar-service/tender/${o.data.data.id}`,t)).data}function la({config:a}={}){return ke(ia,{...a,onSuccess:(...s)=>{Pe.invalidateQueries(["carts"]),a!=null&&a.onSuccess&&a.onSuccess(...s)}})}async function ca({params:a}){return(await C.get("/ar-service/tender",{params:a})).data.data}function da({config:a,params:s}={}){return Z({...a,queryKey:["tenders",s],queryFn:()=>ca({params:s}),keepPreviousData:!0})}const ua={main:"Unit",accessories:"Accessories",preventive:"Service/Sparepart"},ce=({carts:a,selected:s,onChange:t,readOnly:r=!1})=>{const{updateCart:o}=A();async function i(n,l){if(l==0)return ee.openConfirmModal({title:"Hapus Keranjang",children:e.jsx("div",{className:"text-sm",children:"Apakah Anda yakin untuk menghapus keranjang?"}),onConfirm:async()=>{await o(n,l)}});await o(n,l)}function c(n){return()=>s.includes(n)?t(s.filter(l=>l!==n)):t([...s,n])}return e.jsx("div",{className:"divide-y divide-gray-300",children:a.map(n=>e.jsxs("div",{className:"bg-white w-full px-4 py-4 flex items-center",children:[e.jsxs("div",{className:"flex-grow flex items-center space-x-4",children:[!r&&e.jsx("div",{children:e.jsx(I,{checked:s.includes(n.product_id),onChange:c(n.product_id)})}),e.jsx("div",{className:"w-20 h-20 bg-gray-200 rounded-md flex-shrink-0"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-primary-600 text-sm",children:ua[n.product.type]}),e.jsx("div",{className:"text-gray-900 font-semibold",children:n.product.name}),e.jsxs("div",{className:"text-primary-600 text-sm",children:[n.product.brand.name,", ",n.product.category.name]})]})]}),e.jsx("div",{className:"flex-shrink-0",children:r?e.jsxs("div",{className:"text-sm text-primary-600",children:["Jumlah (",e.jsx("strong",{children:n.quantity}),")"]}):e.jsxs("div",{className:"flex items-center justify-center flex-shrink-0",children:[e.jsx(G,{onClick:()=>i(n.id,n.quantity-1),size:20,variant:"outline",color:"primary",radius:"100%",children:e.jsx(oa,{className:"p-px"})}),e.jsx(De,{hideControls:!0,min:0,step:1,variant:"unstyled",readOnly:!0,value:n.quantity,className:"[&_input]:w-8 [&_input]:text-center border-b border-gray-200 px-2"}),e.jsx(G,{onClick:()=>i(n.id,n.quantity+1),size:20,variant:"outline",color:"primary",radius:"100%",children:e.jsx(Ae,{className:"p-px"})})]})})]},n.id))})},ma=({status:a})=>{switch(a){case"pending":return e.jsx(_,{variant:"light",color:"gray",children:"Menunggu"});case"approved":return e.jsx(_,{variant:"light",color:"green",children:"Diterima"});case"rejected":return e.jsx(_,{variant:"light",color:"red",children:"Ditolak"});default:return e.jsx(_,{variant:"light",color:"gray",children:"Pending"})}},pa={page:1,limit:10,search:""},ha={main:"Unit",accessories:"Accessories",preventive:"Service/Sparepart"},xa=({toolbar:a})=>{const[s,t]=p.useState(pa),{data:r,isLoading:o}=da({params:s});return e.jsx($e,{title:"Tabel Data Penawaran",toolbar:a,header:["Produk","PIC","Status","Diperbaharui",""],items:r==null?void 0:r.data,onPageChange:i=>{t({...s,page:i})},loading:o,metadata:{count:(r==null?void 0:r.data.length)||10,limit:s.limit||10,page:s.page||10,total:(r==null?void 0:r.total)||10},renderItem:i=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("div",{className:"text-xs text-primary-600",children:ha[i.details[0].product.type]}),e.jsx("div",{className:"text-sm text-gray-900",children:i.details[0].product.name}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"+ 3 produk lainnya"})]}),e.jsxs("td",{children:[e.jsxs("div",{className:"text-gray-900",children:[i.recipient_name," / ",i.recipient_phone]}),e.jsx("div",{className:"text-xs text-gray-600",children:i.recipient_position})]}),e.jsx("td",{children:e.jsx(ma,{status:i.status})}),e.jsx("td",{children:_e(i.updatedAt).format("D MMMM YYYY H:mm")}),e.jsx("td",{})]},i.id)})},_a=()=>{const{carts:a}=A(),[s,t]=se({key:"selected-cart",defaultValue:[]}),r=p.useMemo(()=>a.filter(({product_id:o})=>s.includes(o)).reduce((o,i)=>o+i.quantity,0),[a,s]);return e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Keranjang"})}),e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-12 lg:col-span-8 rounded-md overflow-hidden",children:[e.jsx(ce,{carts:a,selected:s,onChange:o=>t(o)}),a.length==0&&e.jsxs("div",{className:"bg-white rounded-md w-full p-12 flex flex-col items-center justify-center text-center",children:[e.jsx(na,{size:42,stroke:1.2,className:"text-gray-600 mb-2"}),e.jsx("h3",{className:"text-lg font-bold",children:"Keranjang Kosong"}),e.jsx("p",{className:"mb-4 text-gray-600",children:"Anda belum pernah menambahkan produk kedalam keranjang"}),e.jsx(q,{leftSection:e.jsx(Ce,{size:17}),children:"Lihat Katalog"})]})]}),e.jsx("div",{className:"col-span-12 lg:col-span-4",children:e.jsxs("div",{className:"bg-white w-full p-4 rounded-md",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[e.jsx("h3",{className:"text-base text-gray-800 font-medium mb-2",children:"Ringkasan Belanja"}),e.jsxs("p",{className:"text-primary-600 text-sm",children:["Jumlah Barang (",r,")"]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(q,{component:Se,to:"/cart/checkout",fullWidth:!0,disabled:s.length==0,children:"Beli"})})]})})]})]})};async function ga(){return(await C.get("/ar-service/profile/biodata")).data.data}function va({config:a}={}){return Z({...a,queryKey:["biodata"],queryFn:()=>ga()})}const Ca=()=>{const{carts:a}=A(),s=Oe(),{data:t,isLoading:r,isError:o}=va(),i=la(),c=Ie({initialValues:{name:"",products:[],address:"",kecamatan_id:void 0,phone:"",position:""}}),[n,l]=se({key:"selected-cart",defaultValue:[]}),f=c.onSubmit(async u=>{ee.openConfirmModal({title:"Checkout",children:e.jsx("div",{className:"text-sm",children:"Apakah data yang Anda masukan sudah benar?"}),onConfirm:async()=>{await i.mutateAsync({data:{...u,products:n}},{onSuccess:()=>{K.show({message:"Penawaran berhasil dibuat",color:"green"}),l([]),s("/tender")},onError:()=>{K.show({message:"Penawaran gagal dibuat",color:"green"})}})}})});p.useEffect(()=>{t&&c.setValues({...c.values,address:t.address,kecamatan_id:t.kecamatan_id,phone:t.phone_number})},[t]);const h=p.useMemo(()=>a.filter(({product_id:u})=>n.includes(u)).reduce((u,x)=>u+x.quantity,0),[a,n]);return r||o?e.jsx("div",{className:"my-24",children:e.jsx(Te,{})}):e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Checkout"})}),e.jsxs("form",{onSubmit:f,className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-12 md:col-span-8 lg:col-span-9 space-y-6",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs(ze,{p:"lg",children:[e.jsx("div",{className:"border-b border-gray-200 pb-2",children:e.jsx("h2",{className:"text-base text-gray-900 font-medium",children:"Penanggung Jawab"})}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 py-2",children:[e.jsx(N,{...c.getInputProps("name"),required:!0,label:"Nama PIC",placeholder:"Ex :  Sarimin"}),e.jsx(N,{...c.getInputProps("position"),required:!0,label:"Jabatan",placeholder:"Ex : Direktur"}),e.jsx(N,{label:"Nomor HP",required:!0,placeholder:"Ex : 085752140606"})]}),e.jsx("div",{className:"border-b border-gray-200 pb-2 mt-4",children:e.jsx("h2",{className:"text-base text-gray-900 font-medium",children:"Alamat Pengiriman"})}),e.jsxs("div",{className:"pt-2 grid md:grid-cols-3 grid-cols-3 gap-6",children:[e.jsx(N,{required:!0,label:"Instansi",placeholder:"Masukan Alamat",defaultValue:t.name,readOnly:!0}),e.jsx(N,{...c.getInputProps("phone"),required:!0,label:"No Telepon",placeholder:"Masukan No Telepon"}),e.jsx(N,{...c.getInputProps("address"),required:!0,label:"Alamat",placeholder:"Masukan Alamat"})]})]})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Pesanan"}),e.jsx("div",{className:"rounded-md overflow-hidden",children:e.jsx(ce,{carts:a.filter(({product_id:u})=>n.includes(u)),selected:n,onChange:u=>l(u),readOnly:!0})})]})]}),e.jsx("div",{className:"col-span-12 md:col-span-4 lg:col-span-3",children:e.jsxs("div",{className:"bg-white w-full p-4 rounded-md",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[e.jsx("h3",{className:"text-base text-gray-800 font-medium mb-2",children:"Ringkasan Belanja"}),e.jsxs("p",{className:"text-primary-600 text-sm",children:["Jumlah Barang (",h,")"]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(q,{type:"submit",fullWidth:!0,disabled:n.length==0,loading:i.isLoading,children:"Penawaran"})})]})})]})]})},Sa=()=>e.jsxs("main",{children:[e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Data Penawaran"})}),e.jsx("section",{className:"mb-8",children:e.jsx(xa,{})})]});export{ce as CartList,Ea as CartMenu,Ma as CartProvider,_a as Carts,Ca as Checkout,xa as TenderTable,Sa as Tenders,A as useCart};
